<!DOCTYPE html>
<html>
<head>
  <title>aes.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/browserify-aes/aes.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>aes.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<p>based on the aes implimentation in triple sec
https://github.com/keybase/triplesec
which is in turn based on the one from crypto-js
https://code.google.com/p/crypto-js/</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> Buffer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'safe-buffer'</span>).Buffer

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asUInt32Array</span> (<span class="hljs-params">buf</span>) </span>{
  <span class="hljs-keyword">if</span> (!Buffer.isBuffer(buf)) buf = Buffer.from(buf)

  <span class="hljs-keyword">var</span> len = (buf.length / <span class="hljs-number">4</span>) | <span class="hljs-number">0</span>
  <span class="hljs-keyword">var</span> out = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(len)

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
    out[i] = buf.readUInt32BE(i * <span class="hljs-number">4</span>)
  }

  <span class="hljs-keyword">return</span> out
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scrubVec</span> (<span class="hljs-params">v</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; v.length; v++) {
    v[i] = <span class="hljs-number">0</span>
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cryptBlock</span> (<span class="hljs-params">M, keySchedule, SUB_MIX, SBOX, nRounds</span>) </span>{
  <span class="hljs-keyword">var</span> SUB_MIX0 = SUB_MIX[<span class="hljs-number">0</span>]
  <span class="hljs-keyword">var</span> SUB_MIX1 = SUB_MIX[<span class="hljs-number">1</span>]
  <span class="hljs-keyword">var</span> SUB_MIX2 = SUB_MIX[<span class="hljs-number">2</span>]
  <span class="hljs-keyword">var</span> SUB_MIX3 = SUB_MIX[<span class="hljs-number">3</span>]

  <span class="hljs-keyword">var</span> s0 = M[<span class="hljs-number">0</span>] ^ keySchedule[<span class="hljs-number">0</span>]
  <span class="hljs-keyword">var</span> s1 = M[<span class="hljs-number">1</span>] ^ keySchedule[<span class="hljs-number">1</span>]
  <span class="hljs-keyword">var</span> s2 = M[<span class="hljs-number">2</span>] ^ keySchedule[<span class="hljs-number">2</span>]
  <span class="hljs-keyword">var</span> s3 = M[<span class="hljs-number">3</span>] ^ keySchedule[<span class="hljs-number">3</span>]
  <span class="hljs-keyword">var</span> t0, t1, t2, t3
  <span class="hljs-keyword">var</span> ksRow = <span class="hljs-number">4</span>

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> round = <span class="hljs-number">1</span>; round &lt; nRounds; round++) {
    t0 = SUB_MIX0[s0 &gt;&gt;&gt; <span class="hljs-number">24</span>] ^ SUB_MIX1[(s1 &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] ^ SUB_MIX2[(s2 &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] ^ SUB_MIX3[s3 &amp; <span class="hljs-number">0xff</span>] ^ keySchedule[ksRow++]
    t1 = SUB_MIX0[s1 &gt;&gt;&gt; <span class="hljs-number">24</span>] ^ SUB_MIX1[(s2 &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] ^ SUB_MIX2[(s3 &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] ^ SUB_MIX3[s0 &amp; <span class="hljs-number">0xff</span>] ^ keySchedule[ksRow++]
    t2 = SUB_MIX0[s2 &gt;&gt;&gt; <span class="hljs-number">24</span>] ^ SUB_MIX1[(s3 &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] ^ SUB_MIX2[(s0 &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] ^ SUB_MIX3[s1 &amp; <span class="hljs-number">0xff</span>] ^ keySchedule[ksRow++]
    t3 = SUB_MIX0[s3 &gt;&gt;&gt; <span class="hljs-number">24</span>] ^ SUB_MIX1[(s0 &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] ^ SUB_MIX2[(s1 &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] ^ SUB_MIX3[s2 &amp; <span class="hljs-number">0xff</span>] ^ keySchedule[ksRow++]
    s0 = t0
    s1 = t1
    s2 = t2
    s3 = t3
  }

  t0 = ((SBOX[s0 &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span>) | (SBOX[(s1 &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">16</span>) | (SBOX[(s2 &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">8</span>) | SBOX[s3 &amp; <span class="hljs-number">0xff</span>]) ^ keySchedule[ksRow++]
  t1 = ((SBOX[s1 &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span>) | (SBOX[(s2 &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">16</span>) | (SBOX[(s3 &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">8</span>) | SBOX[s0 &amp; <span class="hljs-number">0xff</span>]) ^ keySchedule[ksRow++]
  t2 = ((SBOX[s2 &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span>) | (SBOX[(s3 &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">16</span>) | (SBOX[(s0 &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">8</span>) | SBOX[s1 &amp; <span class="hljs-number">0xff</span>]) ^ keySchedule[ksRow++]
  t3 = ((SBOX[s3 &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span>) | (SBOX[(s0 &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">16</span>) | (SBOX[(s1 &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">8</span>) | SBOX[s2 &amp; <span class="hljs-number">0xff</span>]) ^ keySchedule[ksRow++]
  t0 = t0 &gt;&gt;&gt; <span class="hljs-number">0</span>
  t1 = t1 &gt;&gt;&gt; <span class="hljs-number">0</span>
  t2 = t2 &gt;&gt;&gt; <span class="hljs-number">0</span>
  t3 = t3 &gt;&gt;&gt; <span class="hljs-number">0</span>

  <span class="hljs-keyword">return</span> [t0, t1, t2, t3]
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>AES constants</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> RCON = [<span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x36</span>]
<span class="hljs-keyword">var</span> G = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Compute double table</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">256</span>)
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">256</span>; j++) {
    <span class="hljs-keyword">if</span> (j &lt; <span class="hljs-number">128</span>) {
      d[j] = j &lt;&lt; <span class="hljs-number">1</span>
    } <span class="hljs-keyword">else</span> {
      d[j] = (j &lt;&lt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x11b</span>
    }
  }

  <span class="hljs-keyword">var</span> SBOX = []
  <span class="hljs-keyword">var</span> INV_SBOX = []
  <span class="hljs-keyword">var</span> SUB_MIX = [[], [], [], []]
  <span class="hljs-keyword">var</span> INV_SUB_MIX = [[], [], [], []]

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Walk GF(2^8)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>
  <span class="hljs-keyword">var</span> xi = <span class="hljs-number">0</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">256</span>; ++i) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Compute sbox</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> sx = xi ^ (xi &lt;&lt; <span class="hljs-number">1</span>) ^ (xi &lt;&lt; <span class="hljs-number">2</span>) ^ (xi &lt;&lt; <span class="hljs-number">3</span>) ^ (xi &lt;&lt; <span class="hljs-number">4</span>)
    sx = (sx &gt;&gt;&gt; <span class="hljs-number">8</span>) ^ (sx &amp; <span class="hljs-number">0xff</span>) ^ <span class="hljs-number">0x63</span>
    SBOX[x] = sx
    INV_SBOX[sx] = x

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Compute multiplication</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> x2 = d[x]
    <span class="hljs-keyword">var</span> x4 = d[x2]
    <span class="hljs-keyword">var</span> x8 = d[x4]

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Compute sub bytes, mix columns tables</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> t = (d[sx] * <span class="hljs-number">0x101</span>) ^ (sx * <span class="hljs-number">0x1010100</span>)
    SUB_MIX[<span class="hljs-number">0</span>][x] = (t &lt;&lt; <span class="hljs-number">24</span>) | (t &gt;&gt;&gt; <span class="hljs-number">8</span>)
    SUB_MIX[<span class="hljs-number">1</span>][x] = (t &lt;&lt; <span class="hljs-number">16</span>) | (t &gt;&gt;&gt; <span class="hljs-number">16</span>)
    SUB_MIX[<span class="hljs-number">2</span>][x] = (t &lt;&lt; <span class="hljs-number">8</span>) | (t &gt;&gt;&gt; <span class="hljs-number">24</span>)
    SUB_MIX[<span class="hljs-number">3</span>][x] = t

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Compute inv sub bytes, inv mix columns tables</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    t = (x8 * <span class="hljs-number">0x1010101</span>) ^ (x4 * <span class="hljs-number">0x10001</span>) ^ (x2 * <span class="hljs-number">0x101</span>) ^ (x * <span class="hljs-number">0x1010100</span>)
    INV_SUB_MIX[<span class="hljs-number">0</span>][sx] = (t &lt;&lt; <span class="hljs-number">24</span>) | (t &gt;&gt;&gt; <span class="hljs-number">8</span>)
    INV_SUB_MIX[<span class="hljs-number">1</span>][sx] = (t &lt;&lt; <span class="hljs-number">16</span>) | (t &gt;&gt;&gt; <span class="hljs-number">16</span>)
    INV_SUB_MIX[<span class="hljs-number">2</span>][sx] = (t &lt;&lt; <span class="hljs-number">8</span>) | (t &gt;&gt;&gt; <span class="hljs-number">24</span>)
    INV_SUB_MIX[<span class="hljs-number">3</span>][sx] = t

    <span class="hljs-keyword">if</span> (x === <span class="hljs-number">0</span>) {
      x = xi = <span class="hljs-number">1</span>
    } <span class="hljs-keyword">else</span> {
      x = x2 ^ d[d[d[x8 ^ x2]]]
      xi ^= d[d[xi]]
    }
  }

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">SBOX</span>: SBOX,
    <span class="hljs-attr">INV_SBOX</span>: INV_SBOX,
    <span class="hljs-attr">SUB_MIX</span>: SUB_MIX,
    <span class="hljs-attr">INV_SUB_MIX</span>: INV_SUB_MIX
  }
})()

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AES</span> (<span class="hljs-params">key</span>) </span>{
  <span class="hljs-keyword">this</span>._key = asUInt32Array(key)
  <span class="hljs-keyword">this</span>._reset()
}

AES.blockSize = <span class="hljs-number">4</span> * <span class="hljs-number">4</span>
AES.keySize = <span class="hljs-number">256</span> / <span class="hljs-number">8</span>
AES.prototype.blockSize = AES.blockSize
AES.prototype.keySize = AES.keySize
AES.prototype._reset = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> keyWords = <span class="hljs-keyword">this</span>._key
  <span class="hljs-keyword">var</span> keySize = keyWords.length
  <span class="hljs-keyword">var</span> nRounds = keySize + <span class="hljs-number">6</span>
  <span class="hljs-keyword">var</span> ksRows = (nRounds + <span class="hljs-number">1</span>) * <span class="hljs-number">4</span>

  <span class="hljs-keyword">var</span> keySchedule = []
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>; k &lt; keySize; k++) {
    keySchedule[k] = keyWords[k]
  }

  <span class="hljs-keyword">for</span> (k = keySize; k &lt; ksRows; k++) {
    <span class="hljs-keyword">var</span> t = keySchedule[k - <span class="hljs-number">1</span>]

    <span class="hljs-keyword">if</span> (k % keySize === <span class="hljs-number">0</span>) {
      t = (t &lt;&lt; <span class="hljs-number">8</span>) | (t &gt;&gt;&gt; <span class="hljs-number">24</span>)
      t =
        (G.SBOX[t &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span>) |
        (G.SBOX[(t &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">16</span>) |
        (G.SBOX[(t &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">8</span>) |
        (G.SBOX[t &amp; <span class="hljs-number">0xff</span>])

      t ^= RCON[(k / keySize) | <span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">24</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (keySize &gt; <span class="hljs-number">6</span> &amp;&amp; k % keySize === <span class="hljs-number">4</span>) {
      t =
        (G.SBOX[t &gt;&gt;&gt; <span class="hljs-number">24</span>] &lt;&lt; <span class="hljs-number">24</span>) |
        (G.SBOX[(t &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">16</span>) |
        (G.SBOX[(t &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">8</span>) |
        (G.SBOX[t &amp; <span class="hljs-number">0xff</span>])
    }

    keySchedule[k] = keySchedule[k - keySize] ^ t
  }

  <span class="hljs-keyword">var</span> invKeySchedule = []
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> ik = <span class="hljs-number">0</span>; ik &lt; ksRows; ik++) {
    <span class="hljs-keyword">var</span> ksR = ksRows - ik
    <span class="hljs-keyword">var</span> tt = keySchedule[ksR - (ik % <span class="hljs-number">4</span> ? <span class="hljs-number">0</span> : <span class="hljs-number">4</span>)]

    <span class="hljs-keyword">if</span> (ik &lt; <span class="hljs-number">4</span> || ksR &lt;= <span class="hljs-number">4</span>) {
      invKeySchedule[ik] = tt
    } <span class="hljs-keyword">else</span> {
      invKeySchedule[ik] =
        G.INV_SUB_MIX[<span class="hljs-number">0</span>][G.SBOX[tt &gt;&gt;&gt; <span class="hljs-number">24</span>]] ^
        G.INV_SUB_MIX[<span class="hljs-number">1</span>][G.SBOX[(tt &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>]] ^
        G.INV_SUB_MIX[<span class="hljs-number">2</span>][G.SBOX[(tt &gt;&gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>]] ^
        G.INV_SUB_MIX[<span class="hljs-number">3</span>][G.SBOX[tt &amp; <span class="hljs-number">0xff</span>]]
    }
  }

  <span class="hljs-keyword">this</span>._nRounds = nRounds
  <span class="hljs-keyword">this</span>._keySchedule = keySchedule
  <span class="hljs-keyword">this</span>._invKeySchedule = invKeySchedule
}

AES.prototype.encryptBlockRaw = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">M</span>) </span>{
  M = asUInt32Array(M)
  <span class="hljs-keyword">return</span> cryptBlock(M, <span class="hljs-keyword">this</span>._keySchedule, G.SUB_MIX, G.SBOX, <span class="hljs-keyword">this</span>._nRounds)
}

AES.prototype.encryptBlock = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">M</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-keyword">this</span>.encryptBlockRaw(M)
  <span class="hljs-keyword">var</span> buf = Buffer.allocUnsafe(<span class="hljs-number">16</span>)
  buf.writeUInt32BE(out[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>)
  buf.writeUInt32BE(out[<span class="hljs-number">1</span>], <span class="hljs-number">4</span>)
  buf.writeUInt32BE(out[<span class="hljs-number">2</span>], <span class="hljs-number">8</span>)
  buf.writeUInt32BE(out[<span class="hljs-number">3</span>], <span class="hljs-number">12</span>)
  <span class="hljs-keyword">return</span> buf
}

AES.prototype.decryptBlock = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">M</span>) </span>{
  M = asUInt32Array(M)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>swap</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> m1 = M[<span class="hljs-number">1</span>]
  M[<span class="hljs-number">1</span>] = M[<span class="hljs-number">3</span>]
  M[<span class="hljs-number">3</span>] = m1

  <span class="hljs-keyword">var</span> out = cryptBlock(M, <span class="hljs-keyword">this</span>._invKeySchedule, G.INV_SUB_MIX, G.INV_SBOX, <span class="hljs-keyword">this</span>._nRounds)
  <span class="hljs-keyword">var</span> buf = Buffer.allocUnsafe(<span class="hljs-number">16</span>)
  buf.writeUInt32BE(out[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>)
  buf.writeUInt32BE(out[<span class="hljs-number">3</span>], <span class="hljs-number">4</span>)
  buf.writeUInt32BE(out[<span class="hljs-number">2</span>], <span class="hljs-number">8</span>)
  buf.writeUInt32BE(out[<span class="hljs-number">1</span>], <span class="hljs-number">12</span>)
  <span class="hljs-keyword">return</span> buf
}

AES.prototype.scrub = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  scrubVec(<span class="hljs-keyword">this</span>._keySchedule)
  scrubVec(<span class="hljs-keyword">this</span>._invKeySchedule)
  scrubVec(<span class="hljs-keyword">this</span>._key)
}

<span class="hljs-built_in">module</span>.exports.AES = AES

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
