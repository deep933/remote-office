<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/buffer/index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#helper-functions">HELPER FUNCTIONS</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>!
The buffer module from node.js, for the browser.</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-comment">/* eslint-disable no-proto */</span>

<span class="hljs-meta">'use strict'</span>

<span class="hljs-keyword">var</span> base64 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'base64-js'</span>)
<span class="hljs-keyword">var</span> ieee754 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ieee754'</span>)
<span class="hljs-keyword">var</span> isArray = <span class="hljs-built_in">require</span>(<span class="hljs-string">'isarray'</span>)

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = <span class="hljs-number">50</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>If <code>Buffer.TYPED_ARRAY_SUPPORT</code>:
=== true    Use Uint8Array implementation (fastest)
=== false   Use Object implementation (most compatible, even IE6)</p>
</div>
<div class="body">
<p>Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
Opera 11.6+, iOS 4.2+.</p>
<p>Due to various browser bugs, sometimes the Object implementation will be used even
when the browser supports typed arrays.</p>
<p>Note:</p>
<ul>
<li>
<p>Firefox 4-29 lacks support for adding new properties to <code>Uint8Array</code> instances,
See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.</p>
</li>
<li>
<p>Chrome 9-10 is missing the <code>TypedArray.prototype.subarray</code> function.</p>
</li>
<li>
<p>IE10 has a broken <code>TypedArray.prototype.subarray</code> function which returns arrays of
incorrect length in some situations.</p>
</li>
</ul>
<p>We detect these buggy browsers and set <code>Buffer.TYPED_ARRAY_SUPPORT</code> to <code>false</code> so they
get the Object implementation, which is slower but behaves correctly.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== <span class="hljs-literal">undefined</span>
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>Export kMaxLength after typed array support is determined.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">exports.kMaxLength = kMaxLength()

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">typedArraySupport</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">var</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">1</span>)
    arr.__proto__ = {<span class="hljs-attr">__proto__</span>: <span class="hljs-built_in">Uint8Array</span>.prototype, <span class="hljs-attr">foo</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-number">42</span> }}
    <span class="hljs-keyword">return</span> arr.foo() === <span class="hljs-number">42</span> &amp;&amp; <span class="hljs-comment">// typed array instances can be augmented</span>
        <span class="hljs-keyword">typeof</span> arr.subarray === <span class="hljs-string">'function'</span> &amp;&amp; <span class="hljs-comment">// chrome 9-10 lack `subarray`</span>
        arr.subarray(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).byteLength === <span class="hljs-number">0</span> <span class="hljs-comment">// ie10 has broken `subarray`</span>
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">kMaxLength</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> Buffer.TYPED_ARRAY_SUPPORT
    ? <span class="hljs-number">0x7fffffff</span>
    : <span class="hljs-number">0x3fffffff</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createBuffer</span> (<span class="hljs-params">that, length</span>) </span>{
  <span class="hljs-keyword">if</span> (kMaxLength() &lt; length) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Invalid typed array length'</span>)
  }
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Return an augmented <code>Uint8Array</code> instance, for best performance</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    that = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(length)
    that.__proto__ = Buffer.prototype
  } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Fallback: Return an object instance of the Buffer class</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (that === <span class="hljs-literal">null</span>) {
      that = <span class="hljs-keyword">new</span> Buffer(length)
    }
    that.length = length
  }

  <span class="hljs-keyword">return</span> that
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<div class="dox">
<div class="summary">
<p>The Buffer constructor returns instances of <code>Uint8Array</code> that have their
prototype changed to <code>Buffer.prototype</code>. Furthermore, <code>Buffer</code> is a subclass of
<code>Uint8Array</code>, so the returned instances will have all the node <code>Buffer</code> methods
and the <code>Uint8Array</code> methods. Square bracket notation works as expected -- it
returns a single octet.</p>
</div>
<div class="body">
<p>The <code>Uint8Array</code> prototype remains unmodified.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Buffer</span> (<span class="hljs-params">arg, encodingOrOffset, length</span>) </span>{
  <span class="hljs-keyword">if</span> (!Buffer.TYPED_ARRAY_SUPPORT &amp;&amp; !(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Buffer)) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Buffer(arg, encodingOrOffset, length)
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Common case.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> arg === <span class="hljs-string">'number'</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> encodingOrOffset === <span class="hljs-string">'string'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        <span class="hljs-string">'If encoding is specified then the first argument must be a string'</span>
      )
    }
    <span class="hljs-keyword">return</span> allocUnsafe(<span class="hljs-keyword">this</span>, arg)
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">this</span>, arg, encodingOrOffset, length)
}

Buffer.poolSize = <span class="hljs-number">8192</span> <span class="hljs-comment">// not used by this implementation</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>TODO: Legacy, not needed anymore. Remove in next major version.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer._augment = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">arr</span>) </span>{
  arr.__proto__ = Buffer.prototype
  <span class="hljs-keyword">return</span> arr
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">from</span> (<span class="hljs-params">that, value, encodingOrOffset, length</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'number'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'"value" argument must not be a number'</span>)
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">ArrayBuffer</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>) {
    <span class="hljs-keyword">return</span> fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'string'</span>) {
    <span class="hljs-keyword">return</span> fromString(that, value, encodingOrOffset)
  }

  <span class="hljs-keyword">return</span> fromObject(that, value)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<div class="dox">
<div class="summary">
<p>Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
if value is a number.
Buffer.from(str[, encoding])
Buffer.from(array)
Buffer.from(buffer)
Buffer.from(arrayBuffer[, byteOffset[, length]])</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer.from = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value, encodingOrOffset, length</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">from</span>(<span class="hljs-literal">null</span>, value, encodingOrOffset, length)
}

<span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = <span class="hljs-built_in">Uint8Array</span>.prototype
  Buffer.__proto__ = <span class="hljs-built_in">Uint8Array</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Symbol</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">Symbol</span>.species &amp;&amp;
      Buffer[<span class="hljs-built_in">Symbol</span>.species] === Buffer) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-built_in">Object</span>.defineProperty(Buffer, <span class="hljs-built_in">Symbol</span>.species, {
      <span class="hljs-attr">value</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>
    })
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertSize</span> (<span class="hljs-params">size</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> size !== <span class="hljs-string">'number'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'"size" argument must be a number'</span>)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (size &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'"size" argument must not be negative'</span>)
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">alloc</span> (<span class="hljs-params">that, size, fill, encoding</span>) </span>{
  assertSize(size)
  <span class="hljs-keyword">if</span> (size &lt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> createBuffer(that, size)
  }
  <span class="hljs-keyword">if</span> (fill !== <span class="hljs-literal">undefined</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Only pay attention to encoding if it's a string. This
prevents accidentally sending in a number that would
be interpretted as a start offset.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> encoding === <span class="hljs-string">'string'</span>
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  <span class="hljs-keyword">return</span> createBuffer(that, size)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<div class="dox">
<div class="summary">
<p>Creates a new filled Buffer instance.
alloc(size[, fill[, encoding]])</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer.alloc = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">size, fill, encoding</span>) </span>{
  <span class="hljs-keyword">return</span> alloc(<span class="hljs-literal">null</span>, size, fill, encoding)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">allocUnsafe</span> (<span class="hljs-params">that, size</span>) </span>{
  assertSize(size)
  that = createBuffer(that, size &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : checked(size) | <span class="hljs-number">0</span>)
  <span class="hljs-keyword">if</span> (!Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; size; ++i) {
      that[i] = <span class="hljs-number">0</span>
    }
  }
  <span class="hljs-keyword">return</span> that
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer.allocUnsafe = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">size</span>) </span>{
  <span class="hljs-keyword">return</span> allocUnsafe(<span class="hljs-literal">null</span>, size)
}
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<div class="dox">
<div class="summary">
<p>Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer.allocUnsafeSlow = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">size</span>) </span>{
  <span class="hljs-keyword">return</span> allocUnsafe(<span class="hljs-literal">null</span>, size)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromString</span> (<span class="hljs-params">that, string, encoding</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> encoding !== <span class="hljs-string">'string'</span> || encoding === <span class="hljs-string">''</span>) {
    encoding = <span class="hljs-string">'utf8'</span>
  }

  <span class="hljs-keyword">if</span> (!Buffer.isEncoding(encoding)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'"encoding" must be a valid string encoding'</span>)
  }

  <span class="hljs-keyword">var</span> length = byteLength(string, encoding) | <span class="hljs-number">0</span>
  that = createBuffer(that, length)

  <span class="hljs-keyword">var</span> actual = that.write(string, encoding)

  <span class="hljs-keyword">if</span> (actual !== length) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Writing a hex string, for example, that contains invalid characters will
cause everything after the first invalid character to be ignored. (e.g.
'abxxcd' will be treated as 'ab')</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    that = that.slice(<span class="hljs-number">0</span>, actual)
  }

  <span class="hljs-keyword">return</span> that
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromArrayLike</span> (<span class="hljs-params">that, array</span>) </span>{
  <span class="hljs-keyword">var</span> length = array.length &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : checked(array.length) | <span class="hljs-number">0</span>
  that = createBuffer(that, length)
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; i += <span class="hljs-number">1</span>) {
    that[i] = array[i] &amp; <span class="hljs-number">255</span>
  }
  <span class="hljs-keyword">return</span> that
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromArrayBuffer</span> (<span class="hljs-params">that, array, byteOffset, length</span>) </span>{
  array.byteLength <span class="hljs-comment">// this throws if `array` is not a valid ArrayBuffer</span>

  <span class="hljs-keyword">if</span> (byteOffset &lt; <span class="hljs-number">0</span> || array.byteLength &lt; byteOffset) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'\'offset\' is out of bounds'</span>)
  }

  <span class="hljs-keyword">if</span> (array.byteLength &lt; byteOffset + (length || <span class="hljs-number">0</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'\'length\' is out of bounds'</span>)
  }

  <span class="hljs-keyword">if</span> (byteOffset === <span class="hljs-literal">undefined</span> &amp;&amp; length === <span class="hljs-literal">undefined</span>) {
    array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(array)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span>) {
    array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(array, byteOffset)
  } <span class="hljs-keyword">else</span> {
    array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(array, byteOffset, length)
  }

  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>Return an augmented <code>Uint8Array</code> instance, for best performance</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    that = array
    that.__proto__ = Buffer.prototype
  } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Fallback: Return an object instance of the Buffer class</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    that = fromArrayLike(that, array)
  }
  <span class="hljs-keyword">return</span> that
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromObject</span> (<span class="hljs-params">that, obj</span>) </span>{
  <span class="hljs-keyword">if</span> (Buffer.isBuffer(obj)) {
    <span class="hljs-keyword">var</span> len = checked(obj.length) | <span class="hljs-number">0</span>
    that = createBuffer(that, len)

    <span class="hljs-keyword">if</span> (that.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> that
    }

    obj.copy(that, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, len)
    <span class="hljs-keyword">return</span> that
  }

  <span class="hljs-keyword">if</span> (obj) {
    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">ArrayBuffer</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp;
        obj.buffer <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>) || <span class="hljs-string">'length'</span> <span class="hljs-keyword">in</span> obj) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj.length !== <span class="hljs-string">'number'</span> || isnan(obj.length)) {
        <span class="hljs-keyword">return</span> createBuffer(that, <span class="hljs-number">0</span>)
      }
      <span class="hljs-keyword">return</span> fromArrayLike(that, obj)
    }

    <span class="hljs-keyword">if</span> (obj.type === <span class="hljs-string">'Buffer'</span> &amp;&amp; isArray(obj.data)) {
      <span class="hljs-keyword">return</span> fromArrayLike(that, obj.data)
    }
  }

  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.'</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checked</span> (<span class="hljs-params">length</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>Note: cannot use <code>length &lt; kMaxLength()</code> here because that fails when
length is NaN (which is otherwise coerced to zero.)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (length &gt;= kMaxLength()) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Attempt to allocate Buffer larger than maximum '</span> +
                         <span class="hljs-string">'size: 0x'</span> + kMaxLength().toString(<span class="hljs-number">16</span>) + <span class="hljs-string">' bytes'</span>)
  }
  <span class="hljs-keyword">return</span> length | <span class="hljs-number">0</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SlowBuffer</span> (<span class="hljs-params">length</span>) </span>{
  <span class="hljs-keyword">if</span> (+length != length) { <span class="hljs-comment">// eslint-disable-line eqeqeq</span>
    length = <span class="hljs-number">0</span>
  }
  <span class="hljs-keyword">return</span> Buffer.alloc(+length)
}

Buffer.isBuffer = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBuffer</span> (<span class="hljs-params">b</span>) </span>{
  <span class="hljs-keyword">return</span> !!(b != <span class="hljs-literal">null</span> &amp;&amp; b._isBuffer)
}

Buffer.compare = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compare</span> (<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">if</span> (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Arguments must be Buffers'</span>)
  }

  <span class="hljs-keyword">if</span> (a === b) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

  <span class="hljs-keyword">var</span> x = a.length
  <span class="hljs-keyword">var</span> y = b.length

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = <span class="hljs-built_in">Math</span>.min(x, y); i &lt; len; ++i) {
    <span class="hljs-keyword">if</span> (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      <span class="hljs-keyword">break</span>
    }
  }

  <span class="hljs-keyword">if</span> (x &lt; y) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
  <span class="hljs-keyword">if</span> (y &lt; x) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
}

Buffer.isEncoding = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isEncoding</span> (<span class="hljs-params">encoding</span>) </span>{
  <span class="hljs-keyword">switch</span> (<span class="hljs-built_in">String</span>(encoding).toLowerCase()) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'hex'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'utf8'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'utf-8'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'ascii'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'latin1'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'binary'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'base64'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'ucs2'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'ucs-2'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'utf16le'</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">'utf-16le'</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }
}

Buffer.concat = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">concat</span> (<span class="hljs-params">list, length</span>) </span>{
  <span class="hljs-keyword">if</span> (!isArray(list)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'"list" argument must be an Array of Buffers'</span>)
  }

  <span class="hljs-keyword">if</span> (list.length === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> Buffer.alloc(<span class="hljs-number">0</span>)
  }

  <span class="hljs-keyword">var</span> i
  <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span>) {
    length = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; list.length; ++i) {
      length += list[i].length
    }
  }

  <span class="hljs-keyword">var</span> buffer = Buffer.allocUnsafe(length)
  <span class="hljs-keyword">var</span> pos = <span class="hljs-number">0</span>
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; list.length; ++i) {
    <span class="hljs-keyword">var</span> buf = list[i]
    <span class="hljs-keyword">if</span> (!Buffer.isBuffer(buf)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'"list" argument must be an Array of Buffers'</span>)
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  <span class="hljs-keyword">return</span> buffer
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">byteLength</span> (<span class="hljs-params">string, encoding</span>) </span>{
  <span class="hljs-keyword">if</span> (Buffer.isBuffer(string)) {
    <span class="hljs-keyword">return</span> string.length
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">ArrayBuffer</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">ArrayBuffer</span>.isView === <span class="hljs-string">'function'</span> &amp;&amp;
      (<span class="hljs-built_in">ArrayBuffer</span>.isView(string) || string <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>)) {
    <span class="hljs-keyword">return</span> string.byteLength
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> string !== <span class="hljs-string">'string'</span>) {
    string = <span class="hljs-string">''</span> + string
  }

  <span class="hljs-keyword">var</span> len = string.length
  <span class="hljs-keyword">if</span> (len === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>Use a for loop to avoid recursion</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> loweredCase = <span class="hljs-literal">false</span>
  <span class="hljs-keyword">for</span> (;;) {
    <span class="hljs-keyword">switch</span> (encoding) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ascii'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'latin1'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'binary'</span>:
        <span class="hljs-keyword">return</span> len
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf8'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf-8'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-literal">undefined</span>:
        <span class="hljs-keyword">return</span> utf8ToBytes(string).length
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ucs2'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ucs-2'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf16le'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf-16le'</span>:
        <span class="hljs-keyword">return</span> len * <span class="hljs-number">2</span>
      <span class="hljs-keyword">case</span> <span class="hljs-string">'hex'</span>:
        <span class="hljs-keyword">return</span> len &gt;&gt;&gt; <span class="hljs-number">1</span>
      <span class="hljs-keyword">case</span> <span class="hljs-string">'base64'</span>:
        <span class="hljs-keyword">return</span> base64ToBytes(string).length
      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">if</span> (loweredCase) <span class="hljs-keyword">return</span> utf8ToBytes(string).length <span class="hljs-comment">// assume utf8</span>
        encoding = (<span class="hljs-string">''</span> + encoding).toLowerCase()
        loweredCase = <span class="hljs-literal">true</span>
    }
  }
}
Buffer.byteLength = byteLength

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">slowToString</span> (<span class="hljs-params">encoding, start, end</span>) </span>{
  <span class="hljs-keyword">var</span> loweredCase = <span class="hljs-literal">false</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>No need to verify that &quot;this.length &lt;= MAX_UINT32&quot; since it's a read-only
property of a typed array.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>This behaves neither like String nor Uint8Array in that we set start/end
to their upper/lower bounds if the value passed is out of range.
undefined is handled specially as per ECMA-262 6th Edition,
Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (start === <span class="hljs-literal">undefined</span> || start &lt; <span class="hljs-number">0</span>) {
    start = <span class="hljs-number">0</span>
  }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>Return early if start &gt; this.length. Done here to prevent potential uint32
coercion fail below.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (start &gt; <span class="hljs-keyword">this</span>.length) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
  }

  <span class="hljs-keyword">if</span> (end === <span class="hljs-literal">undefined</span> || end &gt; <span class="hljs-keyword">this</span>.length) {
    end = <span class="hljs-keyword">this</span>.length
  }

  <span class="hljs-keyword">if</span> (end &lt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>Force coersion to uint32. This will also coerce falsey/NaN values to 0.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  end &gt;&gt;&gt;= <span class="hljs-number">0</span>
  start &gt;&gt;&gt;= <span class="hljs-number">0</span>

  <span class="hljs-keyword">if</span> (end &lt;= start) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
  }

  <span class="hljs-keyword">if</span> (!encoding) encoding = <span class="hljs-string">'utf8'</span>

  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">switch</span> (encoding) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'hex'</span>:
        <span class="hljs-keyword">return</span> hexSlice(<span class="hljs-keyword">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf8'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf-8'</span>:
        <span class="hljs-keyword">return</span> utf8Slice(<span class="hljs-keyword">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'ascii'</span>:
        <span class="hljs-keyword">return</span> asciiSlice(<span class="hljs-keyword">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'latin1'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'binary'</span>:
        <span class="hljs-keyword">return</span> latin1Slice(<span class="hljs-keyword">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'base64'</span>:
        <span class="hljs-keyword">return</span> base64Slice(<span class="hljs-keyword">this</span>, start, end)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'ucs2'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ucs-2'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf16le'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf-16le'</span>:
        <span class="hljs-keyword">return</span> utf16leSlice(<span class="hljs-keyword">this</span>, start, end)

      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">if</span> (loweredCase) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Unknown encoding: '</span> + encoding)
        encoding = (encoding + <span class="hljs-string">''</span>).toLowerCase()
        loweredCase = <span class="hljs-literal">true</span>
    }
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<p>The property is used by <code>Buffer.isBuffer</code> and <code>is-buffer</code> (in Safari 5-7) to detect
Buffer instances.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer.prototype._isBuffer = <span class="hljs-literal">true</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">swap</span> (<span class="hljs-params">b, n, m</span>) </span>{
  <span class="hljs-keyword">var</span> i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">swap16</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> len = <span class="hljs-keyword">this</span>.length
  <span class="hljs-keyword">if</span> (len % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Buffer size must be a multiple of 16-bits'</span>)
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i += <span class="hljs-number">2</span>) {
    swap(<span class="hljs-keyword">this</span>, i, i + <span class="hljs-number">1</span>)
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
}

Buffer.prototype.swap32 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">swap32</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> len = <span class="hljs-keyword">this</span>.length
  <span class="hljs-keyword">if</span> (len % <span class="hljs-number">4</span> !== <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Buffer size must be a multiple of 32-bits'</span>)
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i += <span class="hljs-number">4</span>) {
    swap(<span class="hljs-keyword">this</span>, i, i + <span class="hljs-number">3</span>)
    swap(<span class="hljs-keyword">this</span>, i + <span class="hljs-number">1</span>, i + <span class="hljs-number">2</span>)
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
}

Buffer.prototype.swap64 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">swap64</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> len = <span class="hljs-keyword">this</span>.length
  <span class="hljs-keyword">if</span> (len % <span class="hljs-number">8</span> !== <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Buffer size must be a multiple of 64-bits'</span>)
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; i += <span class="hljs-number">8</span>) {
    swap(<span class="hljs-keyword">this</span>, i, i + <span class="hljs-number">7</span>)
    swap(<span class="hljs-keyword">this</span>, i + <span class="hljs-number">1</span>, i + <span class="hljs-number">6</span>)
    swap(<span class="hljs-keyword">this</span>, i + <span class="hljs-number">2</span>, i + <span class="hljs-number">5</span>)
    swap(<span class="hljs-keyword">this</span>, i + <span class="hljs-number">3</span>, i + <span class="hljs-number">4</span>)
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
}

Buffer.prototype.toString = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toString</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> length = <span class="hljs-keyword">this</span>.length | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> utf8Slice(<span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>, length)
  <span class="hljs-keyword">return</span> slowToString.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)
}

Buffer.prototype.equals = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">equals</span> (<span class="hljs-params">b</span>) </span>{
  <span class="hljs-keyword">if</span> (!Buffer.isBuffer(b)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Argument must be a Buffer'</span>)
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> === b) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  <span class="hljs-keyword">return</span> Buffer.compare(<span class="hljs-keyword">this</span>, b) === <span class="hljs-number">0</span>
}

Buffer.prototype.inspect = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inspect</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> str = <span class="hljs-string">''</span>
  <span class="hljs-keyword">var</span> max = exports.INSPECT_MAX_BYTES
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.length &gt; <span class="hljs-number">0</span>) {
    str = <span class="hljs-keyword">this</span>.toString(<span class="hljs-string">'hex'</span>, <span class="hljs-number">0</span>, max).match(<span class="hljs-regexp">/.{2}/g</span>).join(<span class="hljs-string">' '</span>)
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.length &gt; max) str += <span class="hljs-string">' ... '</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;Buffer '</span> + str + <span class="hljs-string">'&gt;'</span>
}

Buffer.prototype.compare = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compare</span> (<span class="hljs-params">target, start, end, thisStart, thisEnd</span>) </span>{
  <span class="hljs-keyword">if</span> (!Buffer.isBuffer(target)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Argument must be a Buffer'</span>)
  }

  <span class="hljs-keyword">if</span> (start === <span class="hljs-literal">undefined</span>) {
    start = <span class="hljs-number">0</span>
  }
  <span class="hljs-keyword">if</span> (end === <span class="hljs-literal">undefined</span>) {
    end = target ? target.length : <span class="hljs-number">0</span>
  }
  <span class="hljs-keyword">if</span> (thisStart === <span class="hljs-literal">undefined</span>) {
    thisStart = <span class="hljs-number">0</span>
  }
  <span class="hljs-keyword">if</span> (thisEnd === <span class="hljs-literal">undefined</span>) {
    thisEnd = <span class="hljs-keyword">this</span>.length
  }

  <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span> || end &gt; target.length || thisStart &lt; <span class="hljs-number">0</span> || thisEnd &gt; <span class="hljs-keyword">this</span>.length) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'out of range index'</span>)
  }

  <span class="hljs-keyword">if</span> (thisStart &gt;= thisEnd &amp;&amp; start &gt;= end) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
  }
  <span class="hljs-keyword">if</span> (thisStart &gt;= thisEnd) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
  }
  <span class="hljs-keyword">if</span> (start &gt;= end) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
  }

  start &gt;&gt;&gt;= <span class="hljs-number">0</span>
  end &gt;&gt;&gt;= <span class="hljs-number">0</span>
  thisStart &gt;&gt;&gt;= <span class="hljs-number">0</span>
  thisEnd &gt;&gt;&gt;= <span class="hljs-number">0</span>

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> === target) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

  <span class="hljs-keyword">var</span> x = thisEnd - thisStart
  <span class="hljs-keyword">var</span> y = end - start
  <span class="hljs-keyword">var</span> len = <span class="hljs-built_in">Math</span>.min(x, y)

  <span class="hljs-keyword">var</span> thisCopy = <span class="hljs-keyword">this</span>.slice(thisStart, thisEnd)
  <span class="hljs-keyword">var</span> targetCopy = target.slice(start, end)

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; len; ++i) {
    <span class="hljs-keyword">if</span> (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      <span class="hljs-keyword">break</span>
    }
  }

  <span class="hljs-keyword">if</span> (x &lt; y) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
  <span class="hljs-keyword">if</span> (y &lt; x) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<p>Finds either the first index of <code>val</code> in <code>buffer</code> at offset &gt;= <code>byteOffset</code>,
OR the last index of <code>val</code> in <code>buffer</code> at offset &lt;= <code>byteOffset</code>.</p>
<p>Arguments:</p>
<ul>
<li>buffer - a Buffer to search</li>
<li>val - a string, Buffer, or number</li>
<li>byteOffset - an index into <code>buffer</code>; will be clamped to an int32</li>
<li>encoding - an optional encoding, relevant is val is a string</li>
<li>dir - true for indexOf, false for lastIndexOf</li>
</ul>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bidirectionalIndexOf</span> (<span class="hljs-params">buffer, val, byteOffset, encoding, dir</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>Empty buffer means no match</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (buffer.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>Normalize byteOffset</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> byteOffset === <span class="hljs-string">'string'</span>) {
    encoding = byteOffset
    byteOffset = <span class="hljs-number">0</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (byteOffset &gt; <span class="hljs-number">0x7fffffff</span>) {
    byteOffset = <span class="hljs-number">0x7fffffff</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (byteOffset &lt; <span class="hljs-number">-0x80000000</span>) {
    byteOffset = <span class="hljs-number">-0x80000000</span>
  }
  byteOffset = +byteOffset  <span class="hljs-comment">// Coerce to Number.</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(byteOffset)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>byteOffset: it it's undefined, null, NaN, &quot;foo&quot;, etc, search whole buffer</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    byteOffset = dir ? <span class="hljs-number">0</span> : (buffer.length - <span class="hljs-number">1</span>)
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<p>Normalize byteOffset: negative offsets start from the end of the buffer</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (byteOffset &lt; <span class="hljs-number">0</span>) byteOffset = buffer.length + byteOffset
  <span class="hljs-keyword">if</span> (byteOffset &gt;= buffer.length) {
    <span class="hljs-keyword">if</span> (dir) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
    <span class="hljs-keyword">else</span> byteOffset = buffer.length - <span class="hljs-number">1</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (byteOffset &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (dir) byteOffset = <span class="hljs-number">0</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>Normalize val</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'string'</span>) {
    val = Buffer.from(val, encoding)
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<p>Finally, search either indexOf (if dir is true) or lastIndexOf</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (Buffer.isBuffer(val)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<p>Special case: looking for empty string/buffer always fails</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (val.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
    }
    <span class="hljs-keyword">return</span> arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'number'</span>) {
    val = val &amp; <span class="hljs-number">0xFF</span> <span class="hljs-comment">// Search for a byte value [0-255]</span>
    <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT &amp;&amp;
        <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Uint8Array</span>.prototype.indexOf === <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">if</span> (dir) {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Uint8Array</span>.prototype.indexOf.call(buffer, val, byteOffset)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Uint8Array</span>.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    <span class="hljs-keyword">return</span> arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'val must be string, number or Buffer'</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">arrayIndexOf</span> (<span class="hljs-params">arr, val, byteOffset, encoding, dir</span>) </span>{
  <span class="hljs-keyword">var</span> indexSize = <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> arrLength = arr.length
  <span class="hljs-keyword">var</span> valLength = val.length

  <span class="hljs-keyword">if</span> (encoding !== <span class="hljs-literal">undefined</span>) {
    encoding = <span class="hljs-built_in">String</span>(encoding).toLowerCase()
    <span class="hljs-keyword">if</span> (encoding === <span class="hljs-string">'ucs2'</span> || encoding === <span class="hljs-string">'ucs-2'</span> ||
        encoding === <span class="hljs-string">'utf16le'</span> || encoding === <span class="hljs-string">'utf-16le'</span>) {
      <span class="hljs-keyword">if</span> (arr.length &lt; <span class="hljs-number">2</span> || val.length &lt; <span class="hljs-number">2</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
      }
      indexSize = <span class="hljs-number">2</span>
      arrLength /= <span class="hljs-number">2</span>
      valLength /= <span class="hljs-number">2</span>
      byteOffset /= <span class="hljs-number">2</span>
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span> (<span class="hljs-params">buf, i</span>) </span>{
    <span class="hljs-keyword">if</span> (indexSize === <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> buf[i]
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> buf.readUInt16BE(i * indexSize)
    }
  }

  <span class="hljs-keyword">var</span> i
  <span class="hljs-keyword">if</span> (dir) {
    <span class="hljs-keyword">var</span> foundIndex = <span class="hljs-number">-1</span>
    <span class="hljs-keyword">for</span> (i = byteOffset; i &lt; arrLength; i++) {
      <span class="hljs-keyword">if</span> (read(arr, i) === read(val, foundIndex === <span class="hljs-number">-1</span> ? <span class="hljs-number">0</span> : i - foundIndex)) {
        <span class="hljs-keyword">if</span> (foundIndex === <span class="hljs-number">-1</span>) foundIndex = i
        <span class="hljs-keyword">if</span> (i - foundIndex + <span class="hljs-number">1</span> === valLength) <span class="hljs-keyword">return</span> foundIndex * indexSize
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (foundIndex !== <span class="hljs-number">-1</span>) i -= i - foundIndex
        foundIndex = <span class="hljs-number">-1</span>
      }
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (byteOffset + valLength &gt; arrLength) byteOffset = arrLength - valLength
    <span class="hljs-keyword">for</span> (i = byteOffset; i &gt;= <span class="hljs-number">0</span>; i--) {
      <span class="hljs-keyword">var</span> found = <span class="hljs-literal">true</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; valLength; j++) {
        <span class="hljs-keyword">if</span> (read(arr, i + j) !== read(val, j)) {
          found = <span class="hljs-literal">false</span>
          <span class="hljs-keyword">break</span>
        }
      }
      <span class="hljs-keyword">if</span> (found) <span class="hljs-keyword">return</span> i
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>
}

Buffer.prototype.includes = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">includes</span> (<span class="hljs-params">val, byteOffset, encoding</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.indexOf(val, byteOffset, encoding) !== <span class="hljs-number">-1</span>
}

Buffer.prototype.indexOf = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">indexOf</span> (<span class="hljs-params">val, byteOffset, encoding</span>) </span>{
  <span class="hljs-keyword">return</span> bidirectionalIndexOf(<span class="hljs-keyword">this</span>, val, byteOffset, encoding, <span class="hljs-literal">true</span>)
}

Buffer.prototype.lastIndexOf = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lastIndexOf</span> (<span class="hljs-params">val, byteOffset, encoding</span>) </span>{
  <span class="hljs-keyword">return</span> bidirectionalIndexOf(<span class="hljs-keyword">this</span>, val, byteOffset, encoding, <span class="hljs-literal">false</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hexWrite</span> (<span class="hljs-params">buf, string, offset, length</span>) </span>{
  offset = <span class="hljs-built_in">Number</span>(offset) || <span class="hljs-number">0</span>
  <span class="hljs-keyword">var</span> remaining = buf.length - offset
  <span class="hljs-keyword">if</span> (!length) {
    length = remaining
  } <span class="hljs-keyword">else</span> {
    length = <span class="hljs-built_in">Number</span>(length)
    <span class="hljs-keyword">if</span> (length &gt; remaining) {
      length = remaining
    }
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>must be an even number of digits</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> strLen = string.length
  <span class="hljs-keyword">if</span> (strLen % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Invalid hex string'</span>)

  <span class="hljs-keyword">if</span> (length &gt; strLen / <span class="hljs-number">2</span>) {
    length = strLen / <span class="hljs-number">2</span>
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) {
    <span class="hljs-keyword">var</span> parsed = <span class="hljs-built_in">parseInt</span>(string.substr(i * <span class="hljs-number">2</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>)
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(parsed)) <span class="hljs-keyword">return</span> i
    buf[offset + i] = parsed
  }
  <span class="hljs-keyword">return</span> i
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">utf8Write</span> (<span class="hljs-params">buf, string, offset, length</span>) </span>{
  <span class="hljs-keyword">return</span> blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asciiWrite</span> (<span class="hljs-params">buf, string, offset, length</span>) </span>{
  <span class="hljs-keyword">return</span> blitBuffer(asciiToBytes(string), buf, offset, length)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">latin1Write</span> (<span class="hljs-params">buf, string, offset, length</span>) </span>{
  <span class="hljs-keyword">return</span> asciiWrite(buf, string, offset, length)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">base64Write</span> (<span class="hljs-params">buf, string, offset, length</span>) </span>{
  <span class="hljs-keyword">return</span> blitBuffer(base64ToBytes(string), buf, offset, length)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ucs2Write</span> (<span class="hljs-params">buf, string, offset, length</span>) </span>{
  <span class="hljs-keyword">return</span> blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span> (<span class="hljs-params">string, offset, length, encoding</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>Buffer#write(string)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (offset === <span class="hljs-literal">undefined</span>) {
    encoding = <span class="hljs-string">'utf8'</span>
    length = <span class="hljs-keyword">this</span>.length
    offset = <span class="hljs-number">0</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<p>Buffer#write(string, encoding)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> offset === <span class="hljs-string">'string'</span>) {
    encoding = offset
    length = <span class="hljs-keyword">this</span>.length
    offset = <span class="hljs-number">0</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>Buffer#write(string, offset[, length][, encoding])</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isFinite</span>(offset)) {
    offset = offset | <span class="hljs-number">0</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isFinite</span>(length)) {
      length = length | <span class="hljs-number">0</span>
      <span class="hljs-keyword">if</span> (encoding === <span class="hljs-literal">undefined</span>) encoding = <span class="hljs-string">'utf8'</span>
    } <span class="hljs-keyword">else</span> {
      encoding = length
      length = <span class="hljs-literal">undefined</span>
    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<p>legacy write(string, encoding, offset, length) - remove in v0.13</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">'Buffer.write(string, encoding, offset[, length]) is no longer supported'</span>
    )
  }

  <span class="hljs-keyword">var</span> remaining = <span class="hljs-keyword">this</span>.length - offset
  <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span> || length &gt; remaining) length = remaining

  <span class="hljs-keyword">if</span> ((string.length &gt; <span class="hljs-number">0</span> &amp;&amp; (length &lt; <span class="hljs-number">0</span> || offset &lt; <span class="hljs-number">0</span>)) || offset &gt; <span class="hljs-keyword">this</span>.length) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Attempt to write outside buffer bounds'</span>)
  }

  <span class="hljs-keyword">if</span> (!encoding) encoding = <span class="hljs-string">'utf8'</span>

  <span class="hljs-keyword">var</span> loweredCase = <span class="hljs-literal">false</span>
  <span class="hljs-keyword">for</span> (;;) {
    <span class="hljs-keyword">switch</span> (encoding) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'hex'</span>:
        <span class="hljs-keyword">return</span> hexWrite(<span class="hljs-keyword">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf8'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf-8'</span>:
        <span class="hljs-keyword">return</span> utf8Write(<span class="hljs-keyword">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'ascii'</span>:
        <span class="hljs-keyword">return</span> asciiWrite(<span class="hljs-keyword">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'latin1'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'binary'</span>:
        <span class="hljs-keyword">return</span> latin1Write(<span class="hljs-keyword">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'base64'</span>:
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<p>Warning: maxLength not taken into account in base64Write</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">return</span> base64Write(<span class="hljs-keyword">this</span>, string, offset, length)

      <span class="hljs-keyword">case</span> <span class="hljs-string">'ucs2'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'ucs-2'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf16le'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'utf-16le'</span>:
        <span class="hljs-keyword">return</span> ucs2Write(<span class="hljs-keyword">this</span>, string, offset, length)

      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">if</span> (loweredCase) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Unknown encoding: '</span> + encoding)
        encoding = (<span class="hljs-string">''</span> + encoding).toLowerCase()
        loweredCase = <span class="hljs-literal">true</span>
    }
  }
}

Buffer.prototype.toJSON = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toJSON</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'Buffer'</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-keyword">this</span>._arr || <span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>)
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">base64Slice</span> (<span class="hljs-params">buf, start, end</span>) </span>{
  <span class="hljs-keyword">if</span> (start === <span class="hljs-number">0</span> &amp;&amp; end === buf.length) {
    <span class="hljs-keyword">return</span> base64.fromByteArray(buf)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> base64.fromByteArray(buf.slice(start, end))
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">utf8Slice</span> (<span class="hljs-params">buf, start, end</span>) </span>{
  end = <span class="hljs-built_in">Math</span>.min(buf.length, end)
  <span class="hljs-keyword">var</span> res = []

  <span class="hljs-keyword">var</span> i = start
  <span class="hljs-keyword">while</span> (i &lt; end) {
    <span class="hljs-keyword">var</span> firstByte = buf[i]
    <span class="hljs-keyword">var</span> codePoint = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">var</span> bytesPerSequence = (firstByte &gt; <span class="hljs-number">0xEF</span>) ? <span class="hljs-number">4</span>
      : (firstByte &gt; <span class="hljs-number">0xDF</span>) ? <span class="hljs-number">3</span>
      : (firstByte &gt; <span class="hljs-number">0xBF</span>) ? <span class="hljs-number">2</span>
      : <span class="hljs-number">1</span>

    <span class="hljs-keyword">if</span> (i + bytesPerSequence &lt;= end) {
      <span class="hljs-keyword">var</span> secondByte, thirdByte, fourthByte, tempCodePoint

      <span class="hljs-keyword">switch</span> (bytesPerSequence) {
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
          <span class="hljs-keyword">if</span> (firstByte &lt; <span class="hljs-number">0x80</span>) {
            codePoint = firstByte
          }
          <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
          secondByte = buf[i + <span class="hljs-number">1</span>]
          <span class="hljs-keyword">if</span> ((secondByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span>) {
            tempCodePoint = (firstByte &amp; <span class="hljs-number">0x1F</span>) &lt;&lt; <span class="hljs-number">0x6</span> | (secondByte &amp; <span class="hljs-number">0x3F</span>)
            <span class="hljs-keyword">if</span> (tempCodePoint &gt; <span class="hljs-number">0x7F</span>) {
              codePoint = tempCodePoint
            }
          }
          <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
          secondByte = buf[i + <span class="hljs-number">1</span>]
          thirdByte = buf[i + <span class="hljs-number">2</span>]
          <span class="hljs-keyword">if</span> ((secondByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span> &amp;&amp; (thirdByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span>) {
            tempCodePoint = (firstByte &amp; <span class="hljs-number">0xF</span>) &lt;&lt; <span class="hljs-number">0xC</span> | (secondByte &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">0x6</span> | (thirdByte &amp; <span class="hljs-number">0x3F</span>)
            <span class="hljs-keyword">if</span> (tempCodePoint &gt; <span class="hljs-number">0x7FF</span> &amp;&amp; (tempCodePoint &lt; <span class="hljs-number">0xD800</span> || tempCodePoint &gt; <span class="hljs-number">0xDFFF</span>)) {
              codePoint = tempCodePoint
            }
          }
          <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
          secondByte = buf[i + <span class="hljs-number">1</span>]
          thirdByte = buf[i + <span class="hljs-number">2</span>]
          fourthByte = buf[i + <span class="hljs-number">3</span>]
          <span class="hljs-keyword">if</span> ((secondByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span> &amp;&amp; (thirdByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span> &amp;&amp; (fourthByte &amp; <span class="hljs-number">0xC0</span>) === <span class="hljs-number">0x80</span>) {
            tempCodePoint = (firstByte &amp; <span class="hljs-number">0xF</span>) &lt;&lt; <span class="hljs-number">0x12</span> | (secondByte &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">0xC</span> | (thirdByte &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">0x6</span> | (fourthByte &amp; <span class="hljs-number">0x3F</span>)
            <span class="hljs-keyword">if</span> (tempCodePoint &gt; <span class="hljs-number">0xFFFF</span> &amp;&amp; tempCodePoint &lt; <span class="hljs-number">0x110000</span>) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    <span class="hljs-keyword">if</span> (codePoint === <span class="hljs-literal">null</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39"></a>
</div>
<p>we did not generate a valid codePoint so insert a
replacement char (U+FFFD) and advance only 1 byte</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      codePoint = <span class="hljs-number">0xFFFD</span>
      bytesPerSequence = <span class="hljs-number">1</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codePoint &gt; <span class="hljs-number">0xFFFF</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40"></a>
</div>
<p>encode to utf16 (surrogate pair dance)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      codePoint -= <span class="hljs-number">0x10000</span>
      res.push(codePoint &gt;&gt;&gt; <span class="hljs-number">10</span> &amp; <span class="hljs-number">0x3FF</span> | <span class="hljs-number">0xD800</span>)
      codePoint = <span class="hljs-number">0xDC00</span> | codePoint &amp; <span class="hljs-number">0x3FF</span>
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  <span class="hljs-keyword">return</span> decodeCodePointsArray(res)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41"></a>
</div>
<p>Based on http://stackoverflow.com/a/22747272/680742, the browser with
the lowest limit is Chrome, with 0x10000 args.
We go 1 magnitude less, for safety</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> MAX_ARGUMENTS_LENGTH = <span class="hljs-number">0x1000</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decodeCodePointsArray</span> (<span class="hljs-params">codePoints</span>) </span>{
  <span class="hljs-keyword">var</span> len = codePoints.length
  <span class="hljs-keyword">if</span> (len &lt;= MAX_ARGUMENTS_LENGTH) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode.apply(<span class="hljs-built_in">String</span>, codePoints) <span class="hljs-comment">// avoid extra slice()</span>
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42"></a>
</div>
<p>Decode in chunks to avoid &quot;call stack size exceeded&quot;.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> res = <span class="hljs-string">''</span>
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>
  <span class="hljs-keyword">while</span> (i &lt; len) {
    res += <span class="hljs-built_in">String</span>.fromCharCode.apply(
      <span class="hljs-built_in">String</span>,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  <span class="hljs-keyword">return</span> res
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asciiSlice</span> (<span class="hljs-params">buf, start, end</span>) </span>{
  <span class="hljs-keyword">var</span> ret = <span class="hljs-string">''</span>
  end = <span class="hljs-built_in">Math</span>.min(buf.length, end)

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = start; i &lt; end; ++i) {
    ret += <span class="hljs-built_in">String</span>.fromCharCode(buf[i] &amp; <span class="hljs-number">0x7F</span>)
  }
  <span class="hljs-keyword">return</span> ret
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">latin1Slice</span> (<span class="hljs-params">buf, start, end</span>) </span>{
  <span class="hljs-keyword">var</span> ret = <span class="hljs-string">''</span>
  end = <span class="hljs-built_in">Math</span>.min(buf.length, end)

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = start; i &lt; end; ++i) {
    ret += <span class="hljs-built_in">String</span>.fromCharCode(buf[i])
  }
  <span class="hljs-keyword">return</span> ret
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hexSlice</span> (<span class="hljs-params">buf, start, end</span>) </span>{
  <span class="hljs-keyword">var</span> len = buf.length

  <span class="hljs-keyword">if</span> (!start || start &lt; <span class="hljs-number">0</span>) start = <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!end || end &lt; <span class="hljs-number">0</span> || end &gt; len) end = len

  <span class="hljs-keyword">var</span> out = <span class="hljs-string">''</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = start; i &lt; end; ++i) {
    out += toHex(buf[i])
  }
  <span class="hljs-keyword">return</span> out
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">utf16leSlice</span> (<span class="hljs-params">buf, start, end</span>) </span>{
  <span class="hljs-keyword">var</span> bytes = buf.slice(start, end)
  <span class="hljs-keyword">var</span> res = <span class="hljs-string">''</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; bytes.length; i += <span class="hljs-number">2</span>) {
    res += <span class="hljs-built_in">String</span>.fromCharCode(bytes[i] + bytes[i + <span class="hljs-number">1</span>] * <span class="hljs-number">256</span>)
  }
  <span class="hljs-keyword">return</span> res
}

Buffer.prototype.slice = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">slice</span> (<span class="hljs-params">start, end</span>) </span>{
  <span class="hljs-keyword">var</span> len = <span class="hljs-keyword">this</span>.length
  start = ~~start
  end = end === <span class="hljs-literal">undefined</span> ? len : ~~end

  <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span>) {
    start += len
    <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span>) start = <span class="hljs-number">0</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (start &gt; len) {
    start = len
  }

  <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) {
    end += len
    <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) end = <span class="hljs-number">0</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (end &gt; len) {
    end = len
  }

  <span class="hljs-keyword">if</span> (end &lt; start) end = start

  <span class="hljs-keyword">var</span> newBuf
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = <span class="hljs-keyword">this</span>.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> sliceLen = end - start
    newBuf = <span class="hljs-keyword">new</span> Buffer(sliceLen, <span class="hljs-literal">undefined</span>)
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; sliceLen; ++i) {
      newBuf[i] = <span class="hljs-keyword">this</span>[i + start]
    }
  }

  <span class="hljs-keyword">return</span> newBuf
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43"></a>
</div>
<div class="dox">
<div class="summary">
<p>Need to make sure that buffer isn't trying to write out of bounds.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkOffset</span> (<span class="hljs-params">offset, ext, length</span>) </span>{
  <span class="hljs-keyword">if</span> ((offset % <span class="hljs-number">1</span>) !== <span class="hljs-number">0</span> || offset &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'offset is not uint'</span>)
  <span class="hljs-keyword">if</span> (offset + ext &gt; length) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Trying to access beyond buffer length'</span>)
}

Buffer.prototype.readUIntLE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUIntLE</span> (<span class="hljs-params">offset, byteLength, noAssert</span>) </span>{
  offset = offset | <span class="hljs-number">0</span>
  byteLength = byteLength | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, byteLength, <span class="hljs-keyword">this</span>.length)

  <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>[offset]
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>
  <span class="hljs-keyword">while</span> (++i &lt; byteLength &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    val += <span class="hljs-keyword">this</span>[offset + i] * mul
  }

  <span class="hljs-keyword">return</span> val
}

Buffer.prototype.readUIntBE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUIntBE</span> (<span class="hljs-params">offset, byteLength, noAssert</span>) </span>{
  offset = offset | <span class="hljs-number">0</span>
  byteLength = byteLength | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) {
    checkOffset(offset, byteLength, <span class="hljs-keyword">this</span>.length)
  }

  <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>[offset + --byteLength]
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>
  <span class="hljs-keyword">while</span> (byteLength &gt; <span class="hljs-number">0</span> &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    val += <span class="hljs-keyword">this</span>[offset + --byteLength] * mul
  }

  <span class="hljs-keyword">return</span> val
}

Buffer.prototype.readUInt8 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt8</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">1</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[offset]
}

Buffer.prototype.readUInt16LE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt16LE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">2</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[offset] | (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>)
}

Buffer.prototype.readUInt16BE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt16BE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">2</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>[offset] &lt;&lt; <span class="hljs-number">8</span>) | <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>]
}

Buffer.prototype.readUInt32LE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt32LE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">4</span>, <span class="hljs-keyword">this</span>.length)

  <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">this</span>[offset]) |
      (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |
      (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>)) +
      (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">3</span>] * <span class="hljs-number">0x1000000</span>)
}

Buffer.prototype.readUInt32BE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt32BE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">4</span>, <span class="hljs-keyword">this</span>.length)

  <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>[offset] * <span class="hljs-number">0x1000000</span>) +
    ((<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">16</span>) |
    (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>) |
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">3</span>])
}

Buffer.prototype.readIntLE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readIntLE</span> (<span class="hljs-params">offset, byteLength, noAssert</span>) </span>{
  offset = offset | <span class="hljs-number">0</span>
  byteLength = byteLength | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, byteLength, <span class="hljs-keyword">this</span>.length)

  <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>[offset]
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>
  <span class="hljs-keyword">while</span> (++i &lt; byteLength &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    val += <span class="hljs-keyword">this</span>[offset + i] * mul
  }
  mul *= <span class="hljs-number">0x80</span>

  <span class="hljs-keyword">if</span> (val &gt;= mul) val -= <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength)

  <span class="hljs-keyword">return</span> val
}

Buffer.prototype.readIntBE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readIntBE</span> (<span class="hljs-params">offset, byteLength, noAssert</span>) </span>{
  offset = offset | <span class="hljs-number">0</span>
  byteLength = byteLength | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, byteLength, <span class="hljs-keyword">this</span>.length)

  <span class="hljs-keyword">var</span> i = byteLength
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>[offset + --i]
  <span class="hljs-keyword">while</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    val += <span class="hljs-keyword">this</span>[offset + --i] * mul
  }
  mul *= <span class="hljs-number">0x80</span>

  <span class="hljs-keyword">if</span> (val &gt;= mul) val -= <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength)

  <span class="hljs-keyword">return</span> val
}

Buffer.prototype.readInt8 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt8</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">1</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span>[offset] &amp; <span class="hljs-number">0x80</span>)) <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>[offset])
  <span class="hljs-keyword">return</span> ((<span class="hljs-number">0xff</span> - <span class="hljs-keyword">this</span>[offset] + <span class="hljs-number">1</span>) * <span class="hljs-number">-1</span>)
}

Buffer.prototype.readInt16LE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt16LE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">2</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>[offset] | (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>)
  <span class="hljs-keyword">return</span> (val &amp; <span class="hljs-number">0x8000</span>) ? val | <span class="hljs-number">0xFFFF0000</span> : val
}

Buffer.prototype.readInt16BE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt16BE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">2</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">var</span> val = <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] | (<span class="hljs-keyword">this</span>[offset] &lt;&lt; <span class="hljs-number">8</span>)
  <span class="hljs-keyword">return</span> (val &amp; <span class="hljs-number">0x8000</span>) ? val | <span class="hljs-number">0xFFFF0000</span> : val
}

Buffer.prototype.readInt32LE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt32LE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">4</span>, <span class="hljs-keyword">this</span>.length)

  <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>[offset]) |
    (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) |
    (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |
    (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>)
}

Buffer.prototype.readInt32BE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt32BE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">4</span>, <span class="hljs-keyword">this</span>.length)

  <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>[offset] &lt;&lt; <span class="hljs-number">24</span>) |
    (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">16</span>) |
    (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>) |
    (<span class="hljs-keyword">this</span>[offset + <span class="hljs-number">3</span>])
}

Buffer.prototype.readFloatLE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readFloatLE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">4</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">return</span> ieee754.read(<span class="hljs-keyword">this</span>, offset, <span class="hljs-literal">true</span>, <span class="hljs-number">23</span>, <span class="hljs-number">4</span>)
}

Buffer.prototype.readFloatBE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readFloatBE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">4</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">return</span> ieee754.read(<span class="hljs-keyword">this</span>, offset, <span class="hljs-literal">false</span>, <span class="hljs-number">23</span>, <span class="hljs-number">4</span>)
}

Buffer.prototype.readDoubleLE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readDoubleLE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">8</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">return</span> ieee754.read(<span class="hljs-keyword">this</span>, offset, <span class="hljs-literal">true</span>, <span class="hljs-number">52</span>, <span class="hljs-number">8</span>)
}

Buffer.prototype.readDoubleBE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readDoubleBE</span> (<span class="hljs-params">offset, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) checkOffset(offset, <span class="hljs-number">8</span>, <span class="hljs-keyword">this</span>.length)
  <span class="hljs-keyword">return</span> ieee754.read(<span class="hljs-keyword">this</span>, offset, <span class="hljs-literal">false</span>, <span class="hljs-number">52</span>, <span class="hljs-number">8</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkInt</span> (<span class="hljs-params">buf, value, offset, ext, max, min</span>) </span>{
  <span class="hljs-keyword">if</span> (!Buffer.isBuffer(buf)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'"buffer" argument must be a Buffer instance'</span>)
  <span class="hljs-keyword">if</span> (value &gt; max || value &lt; min) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'"value" argument is out of bounds'</span>)
  <span class="hljs-keyword">if</span> (offset + ext &gt; buf.length) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Index out of range'</span>)
}

Buffer.prototype.writeUIntLE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUIntLE</span> (<span class="hljs-params">value, offset, byteLength, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  byteLength = byteLength | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-keyword">var</span> maxBytes = <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength) - <span class="hljs-number">1</span>
    checkInt(<span class="hljs-keyword">this</span>, value, offset, byteLength, maxBytes, <span class="hljs-number">0</span>)
  }

  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>
  <span class="hljs-keyword">this</span>[offset] = value &amp; <span class="hljs-number">0xFF</span>
  <span class="hljs-keyword">while</span> (++i &lt; byteLength &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    <span class="hljs-keyword">this</span>[offset + i] = (value / mul) &amp; <span class="hljs-number">0xFF</span>
  }

  <span class="hljs-keyword">return</span> offset + byteLength
}

Buffer.prototype.writeUIntBE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUIntBE</span> (<span class="hljs-params">value, offset, byteLength, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  byteLength = byteLength | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-keyword">var</span> maxBytes = <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength) - <span class="hljs-number">1</span>
    checkInt(<span class="hljs-keyword">this</span>, value, offset, byteLength, maxBytes, <span class="hljs-number">0</span>)
  }

  <span class="hljs-keyword">var</span> i = byteLength - <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>
  <span class="hljs-keyword">this</span>[offset + i] = value &amp; <span class="hljs-number">0xFF</span>
  <span class="hljs-keyword">while</span> (--i &gt;= <span class="hljs-number">0</span> &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    <span class="hljs-keyword">this</span>[offset + i] = (value / mul) &amp; <span class="hljs-number">0xFF</span>
  }

  <span class="hljs-keyword">return</span> offset + byteLength
}

Buffer.prototype.writeUInt8 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt8</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">1</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0</span>)
  <span class="hljs-keyword">if</span> (!Buffer.TYPED_ARRAY_SUPPORT) value = <span class="hljs-built_in">Math</span>.floor(value)
  <span class="hljs-keyword">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>)
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">1</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">objectWriteUInt16</span> (<span class="hljs-params">buf, value, offset, littleEndian</span>) </span>{
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) value = <span class="hljs-number">0xffff</span> + value + <span class="hljs-number">1</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-built_in">Math</span>.min(buf.length - offset, <span class="hljs-number">2</span>); i &lt; j; ++i) {
    buf[offset + i] = (value &amp; (<span class="hljs-number">0xff</span> &lt;&lt; (<span class="hljs-number">8</span> * (littleEndian ? i : <span class="hljs-number">1</span> - i)))) &gt;&gt;&gt;
      (littleEndian ? i : <span class="hljs-number">1</span> - i) * <span class="hljs-number">8</span>
  }
}

Buffer.prototype.writeUInt16LE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt16LE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">2</span>, <span class="hljs-number">0xffff</span>, <span class="hljs-number">0</span>)
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>)
  } <span class="hljs-keyword">else</span> {
    objectWriteUInt16(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">true</span>)
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">2</span>
}

Buffer.prototype.writeUInt16BE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt16BE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">2</span>, <span class="hljs-number">0xffff</span>, <span class="hljs-number">0</span>)
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">this</span>[offset] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] = (value &amp; <span class="hljs-number">0xff</span>)
  } <span class="hljs-keyword">else</span> {
    objectWriteUInt16(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">false</span>)
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">2</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">objectWriteUInt32</span> (<span class="hljs-params">buf, value, offset, littleEndian</span>) </span>{
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) value = <span class="hljs-number">0xffffffff</span> + value + <span class="hljs-number">1</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-built_in">Math</span>.min(buf.length - offset, <span class="hljs-number">4</span>); i &lt; j; ++i) {
    buf[offset + i] = (value &gt;&gt;&gt; (littleEndian ? i : <span class="hljs-number">3</span> - i) * <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>
  }
}

Buffer.prototype.writeUInt32LE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt32LE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">0xffffffff</span>, <span class="hljs-number">0</span>)
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">3</span>] = (value &gt;&gt;&gt; <span class="hljs-number">24</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">2</span>] = (value &gt;&gt;&gt; <span class="hljs-number">16</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>)
    <span class="hljs-keyword">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>)
  } <span class="hljs-keyword">else</span> {
    objectWriteUInt32(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">true</span>)
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
}

Buffer.prototype.writeUInt32BE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt32BE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">0xffffffff</span>, <span class="hljs-number">0</span>)
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">this</span>[offset] = (value &gt;&gt;&gt; <span class="hljs-number">24</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">16</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">2</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">3</span>] = (value &amp; <span class="hljs-number">0xff</span>)
  } <span class="hljs-keyword">else</span> {
    objectWriteUInt32(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">false</span>)
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
}

Buffer.prototype.writeIntLE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeIntLE</span> (<span class="hljs-params">value, offset, byteLength, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-keyword">var</span> limit = <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength - <span class="hljs-number">1</span>)

    checkInt(<span class="hljs-keyword">this</span>, value, offset, byteLength, limit - <span class="hljs-number">1</span>, -limit)
  }

  <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> sub = <span class="hljs-number">0</span>
  <span class="hljs-keyword">this</span>[offset] = value &amp; <span class="hljs-number">0xFF</span>
  <span class="hljs-keyword">while</span> (++i &lt; byteLength &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span> &amp;&amp; sub === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-keyword">this</span>[offset + i - <span class="hljs-number">1</span>] !== <span class="hljs-number">0</span>) {
      sub = <span class="hljs-number">1</span>
    }
    <span class="hljs-keyword">this</span>[offset + i] = ((value / mul) &gt;&gt; <span class="hljs-number">0</span>) - sub &amp; <span class="hljs-number">0xFF</span>
  }

  <span class="hljs-keyword">return</span> offset + byteLength
}

Buffer.prototype.writeIntBE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeIntBE</span> (<span class="hljs-params">value, offset, byteLength, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) {
    <span class="hljs-keyword">var</span> limit = <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, <span class="hljs-number">8</span> * byteLength - <span class="hljs-number">1</span>)

    checkInt(<span class="hljs-keyword">this</span>, value, offset, byteLength, limit - <span class="hljs-number">1</span>, -limit)
  }

  <span class="hljs-keyword">var</span> i = byteLength - <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> mul = <span class="hljs-number">1</span>
  <span class="hljs-keyword">var</span> sub = <span class="hljs-number">0</span>
  <span class="hljs-keyword">this</span>[offset + i] = value &amp; <span class="hljs-number">0xFF</span>
  <span class="hljs-keyword">while</span> (--i &gt;= <span class="hljs-number">0</span> &amp;&amp; (mul *= <span class="hljs-number">0x100</span>)) {
    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span> &amp;&amp; sub === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-keyword">this</span>[offset + i + <span class="hljs-number">1</span>] !== <span class="hljs-number">0</span>) {
      sub = <span class="hljs-number">1</span>
    }
    <span class="hljs-keyword">this</span>[offset + i] = ((value / mul) &gt;&gt; <span class="hljs-number">0</span>) - sub &amp; <span class="hljs-number">0xFF</span>
  }

  <span class="hljs-keyword">return</span> offset + byteLength
}

Buffer.prototype.writeInt8 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt8</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">1</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">-0x80</span>)
  <span class="hljs-keyword">if</span> (!Buffer.TYPED_ARRAY_SUPPORT) value = <span class="hljs-built_in">Math</span>.floor(value)
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) value = <span class="hljs-number">0xff</span> + value + <span class="hljs-number">1</span>
  <span class="hljs-keyword">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>)
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">1</span>
}

Buffer.prototype.writeInt16LE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt16LE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">2</span>, <span class="hljs-number">0x7fff</span>, <span class="hljs-number">-0x8000</span>)
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>)
  } <span class="hljs-keyword">else</span> {
    objectWriteUInt16(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">true</span>)
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">2</span>
}

Buffer.prototype.writeInt16BE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt16BE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">2</span>, <span class="hljs-number">0x7fff</span>, <span class="hljs-number">-0x8000</span>)
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">this</span>[offset] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] = (value &amp; <span class="hljs-number">0xff</span>)
  } <span class="hljs-keyword">else</span> {
    objectWriteUInt16(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">false</span>)
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">2</span>
}

Buffer.prototype.writeInt32LE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt32LE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">0x7fffffff</span>, <span class="hljs-number">-0x80000000</span>)
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">this</span>[offset] = (value &amp; <span class="hljs-number">0xff</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">2</span>] = (value &gt;&gt;&gt; <span class="hljs-number">16</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">3</span>] = (value &gt;&gt;&gt; <span class="hljs-number">24</span>)
  } <span class="hljs-keyword">else</span> {
    objectWriteUInt32(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">true</span>)
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
}

Buffer.prototype.writeInt32BE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt32BE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  value = +value
  offset = offset | <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!noAssert) checkInt(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">0x7fffffff</span>, <span class="hljs-number">-0x80000000</span>)
  <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) value = <span class="hljs-number">0xffffffff</span> + value + <span class="hljs-number">1</span>
  <span class="hljs-keyword">if</span> (Buffer.TYPED_ARRAY_SUPPORT) {
    <span class="hljs-keyword">this</span>[offset] = (value &gt;&gt;&gt; <span class="hljs-number">24</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">1</span>] = (value &gt;&gt;&gt; <span class="hljs-number">16</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">2</span>] = (value &gt;&gt;&gt; <span class="hljs-number">8</span>)
    <span class="hljs-keyword">this</span>[offset + <span class="hljs-number">3</span>] = (value &amp; <span class="hljs-number">0xff</span>)
  } <span class="hljs-keyword">else</span> {
    objectWriteUInt32(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">false</span>)
  }
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkIEEE754</span> (<span class="hljs-params">buf, value, offset, ext, max, min</span>) </span>{
  <span class="hljs-keyword">if</span> (offset + ext &gt; buf.length) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Index out of range'</span>)
  <span class="hljs-keyword">if</span> (offset &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Index out of range'</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeFloat</span> (<span class="hljs-params">buf, value, offset, littleEndian, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) {
    checkIEEE754(buf, value, offset, <span class="hljs-number">4</span>, <span class="hljs-number">3.4028234663852886e+38</span>, <span class="hljs-number">-3.4028234663852886e+38</span>)
  }
  ieee754.write(buf, value, offset, littleEndian, <span class="hljs-number">23</span>, <span class="hljs-number">4</span>)
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">4</span>
}

Buffer.prototype.writeFloatLE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeFloatLE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  <span class="hljs-keyword">return</span> writeFloat(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">true</span>, noAssert)
}

Buffer.prototype.writeFloatBE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeFloatBE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  <span class="hljs-keyword">return</span> writeFloat(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">false</span>, noAssert)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeDouble</span> (<span class="hljs-params">buf, value, offset, littleEndian, noAssert</span>) </span>{
  <span class="hljs-keyword">if</span> (!noAssert) {
    checkIEEE754(buf, value, offset, <span class="hljs-number">8</span>, <span class="hljs-number">1.7976931348623157E+308</span>, <span class="hljs-number">-1.7976931348623157E+308</span>)
  }
  ieee754.write(buf, value, offset, littleEndian, <span class="hljs-number">52</span>, <span class="hljs-number">8</span>)
  <span class="hljs-keyword">return</span> offset + <span class="hljs-number">8</span>
}

Buffer.prototype.writeDoubleLE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeDoubleLE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  <span class="hljs-keyword">return</span> writeDouble(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">true</span>, noAssert)
}

Buffer.prototype.writeDoubleBE = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeDoubleBE</span> (<span class="hljs-params">value, offset, noAssert</span>) </span>{
  <span class="hljs-keyword">return</span> writeDouble(<span class="hljs-keyword">this</span>, value, offset, <span class="hljs-literal">false</span>, noAssert)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<p>copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer.prototype.copy = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copy</span> (<span class="hljs-params">target, targetStart, start, end</span>) </span>{
  <span class="hljs-keyword">if</span> (!start) start = <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (!end &amp;&amp; end !== <span class="hljs-number">0</span>) end = <span class="hljs-keyword">this</span>.length
  <span class="hljs-keyword">if</span> (targetStart &gt;= target.length) targetStart = target.length
  <span class="hljs-keyword">if</span> (!targetStart) targetStart = <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (end &gt; <span class="hljs-number">0</span> &amp;&amp; end &lt; start) end = start

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<p>Copy 0 bytes; we're done</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (end === start) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
  <span class="hljs-keyword">if</span> (target.length === <span class="hljs-number">0</span> || <span class="hljs-keyword">this</span>.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<p>Fatal error conditions</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (targetStart &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'targetStart out of bounds'</span>)
  }
  <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span> || start &gt;= <span class="hljs-keyword">this</span>.length) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'sourceStart out of bounds'</span>)
  <span class="hljs-keyword">if</span> (end &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'sourceEnd out of bounds'</span>)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<p>Are we oob?</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (end &gt; <span class="hljs-keyword">this</span>.length) end = <span class="hljs-keyword">this</span>.length
  <span class="hljs-keyword">if</span> (target.length - targetStart &lt; end - start) {
    end = target.length - targetStart + start
  }

  <span class="hljs-keyword">var</span> len = end - start
  <span class="hljs-keyword">var</span> i

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> === target &amp;&amp; start &lt; targetStart &amp;&amp; targetStart &lt; end) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<p>descending copy from end</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">for</span> (i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; --i) {
      target[i + targetStart] = <span class="hljs-keyword">this</span>[i + start]
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">1000</span> || !Buffer.TYPED_ARRAY_SUPPORT) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49"></a>
</div>
<p>ascending copy from start</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; ++i) {
      target[i + targetStart] = <span class="hljs-keyword">this</span>[i + start]
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">Uint8Array</span>.prototype.set.call(
      target,
      <span class="hljs-keyword">this</span>.subarray(start, start + len),
      targetStart
    )
  }

  <span class="hljs-keyword">return</span> len
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>Usage:
buffer.fill(number[, offset[, end]])
buffer.fill(buffer[, offset[, end]])
buffer.fill(string[, offset[, end]][, encoding])</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">Buffer.prototype.fill = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fill</span> (<span class="hljs-params">val, start, end, encoding</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<p>Handle string cases:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'string'</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> start === <span class="hljs-string">'string'</span>) {
      encoding = start
      start = <span class="hljs-number">0</span>
      end = <span class="hljs-keyword">this</span>.length
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> end === <span class="hljs-string">'string'</span>) {
      encoding = end
      end = <span class="hljs-keyword">this</span>.length
    }
    <span class="hljs-keyword">if</span> (val.length === <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">var</span> code = val.charCodeAt(<span class="hljs-number">0</span>)
      <span class="hljs-keyword">if</span> (code &lt; <span class="hljs-number">256</span>) {
        val = code
      }
    }
    <span class="hljs-keyword">if</span> (encoding !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> encoding !== <span class="hljs-string">'string'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'encoding must be a string'</span>)
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> encoding === <span class="hljs-string">'string'</span> &amp;&amp; !Buffer.isEncoding(encoding)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Unknown encoding: '</span> + encoding)
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'number'</span>) {
    val = val &amp; <span class="hljs-number">255</span>
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<p>Invalid ranges are not set to a default, so can range check early.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (start &lt; <span class="hljs-number">0</span> || <span class="hljs-keyword">this</span>.length &lt; start || <span class="hljs-keyword">this</span>.length &lt; end) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Out of range index'</span>)
  }

  <span class="hljs-keyword">if</span> (end &lt;= start) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
  }

  start = start &gt;&gt;&gt; <span class="hljs-number">0</span>
  end = end === <span class="hljs-literal">undefined</span> ? <span class="hljs-keyword">this</span>.length : end &gt;&gt;&gt; <span class="hljs-number">0</span>

  <span class="hljs-keyword">if</span> (!val) val = <span class="hljs-number">0</span>

  <span class="hljs-keyword">var</span> i
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'number'</span>) {
    <span class="hljs-keyword">for</span> (i = start; i &lt; end; ++i) {
      <span class="hljs-keyword">this</span>[i] = val
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(<span class="hljs-keyword">new</span> Buffer(val, encoding).toString())
    <span class="hljs-keyword">var</span> len = bytes.length
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; end - start; ++i) {
      <span class="hljs-keyword">this</span>[i + start] = bytes[i % len]
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="helper-functions">
  <h1>
    <a href="#helper-functions" name="helper-functions" class="pilcrow"></a>
HELPER FUNCTIONS
  </h1>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> INVALID_BASE64_RE = <span class="hljs-regexp">/[^+\/0-9A-Za-z-_]/g</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">base64clean</span> (<span class="hljs-params">str</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54"></a>
</div>
<p>Node strips out invalid characters like \n and \t from the string, base64-js does not</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  str = stringtrim(str).replace(INVALID_BASE64_RE, <span class="hljs-string">''</span>)
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55"></a>
</div>
<p>Node converts strings with length &lt; 2 to ''</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (str.length &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56"></a>
</div>
<p>Node allows for non-padded base64 strings (missing trailing ===), base64-js does not</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">while</span> (str.length % <span class="hljs-number">4</span> !== <span class="hljs-number">0</span>) {
    str = str + <span class="hljs-string">'='</span>
  }
  <span class="hljs-keyword">return</span> str
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stringtrim</span> (<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">if</span> (str.trim) <span class="hljs-keyword">return</span> str.trim()
  <span class="hljs-keyword">return</span> str.replace(<span class="hljs-regexp">/^\s+|\s+$/g</span>, <span class="hljs-string">''</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toHex</span> (<span class="hljs-params">n</span>) </span>{
  <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">16</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'0'</span> + n.toString(<span class="hljs-number">16</span>)
  <span class="hljs-keyword">return</span> n.toString(<span class="hljs-number">16</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">utf8ToBytes</span> (<span class="hljs-params">string, units</span>) </span>{
  units = units || <span class="hljs-literal">Infinity</span>
  <span class="hljs-keyword">var</span> codePoint
  <span class="hljs-keyword">var</span> length = string.length
  <span class="hljs-keyword">var</span> leadSurrogate = <span class="hljs-literal">null</span>
  <span class="hljs-keyword">var</span> bytes = []

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) {
    codePoint = string.charCodeAt(i)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57"></a>
</div>
<p>is surrogate component</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (codePoint &gt; <span class="hljs-number">0xD7FF</span> &amp;&amp; codePoint &lt; <span class="hljs-number">0xE000</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58"></a>
</div>
<p>last char was a lead</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (!leadSurrogate) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59"></a>
</div>
<p>no lead yet</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (codePoint &gt; <span class="hljs-number">0xDBFF</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60"></a>
</div>
<p>unexpected trail</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &gt; <span class="hljs-number">-1</span>) bytes.push(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBD</span>)
          <span class="hljs-keyword">continue</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> === length) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61"></a>
</div>
<p>unpaired lead</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &gt; <span class="hljs-number">-1</span>) bytes.push(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBD</span>)
          <span class="hljs-keyword">continue</span>
        }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62"></a>
</div>
<p>valid lead</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        leadSurrogate = codePoint

        <span class="hljs-keyword">continue</span>
      }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63"></a>
</div>
<p>2 leads in a row</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0xDC00</span>) {
        <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &gt; <span class="hljs-number">-1</span>) bytes.push(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBD</span>)
        leadSurrogate = codePoint
        <span class="hljs-keyword">continue</span>
      }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64"></a>
</div>
<p>valid surrogate pair</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      codePoint = (leadSurrogate - <span class="hljs-number">0xD800</span> &lt;&lt; <span class="hljs-number">10</span> | codePoint - <span class="hljs-number">0xDC00</span>) + <span class="hljs-number">0x10000</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (leadSurrogate) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65"></a>
</div>
<p>valid bmp char, but last char was a lead</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &gt; <span class="hljs-number">-1</span>) bytes.push(<span class="hljs-number">0xEF</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xBD</span>)
    }

    leadSurrogate = <span class="hljs-literal">null</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66"></a>
</div>
<p>encode utf8</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0x80</span>) {
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">1</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
      bytes.push(codePoint)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0x800</span>) {
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">2</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
      bytes.push(
        codePoint &gt;&gt; <span class="hljs-number">0x6</span> | <span class="hljs-number">0xC0</span>,
        codePoint &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>
      )
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0x10000</span>) {
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">3</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
      bytes.push(
        codePoint &gt;&gt; <span class="hljs-number">0xC</span> | <span class="hljs-number">0xE0</span>,
        codePoint &gt;&gt; <span class="hljs-number">0x6</span> &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>,
        codePoint &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>
      )
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codePoint &lt; <span class="hljs-number">0x110000</span>) {
      <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">4</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
      bytes.push(
        codePoint &gt;&gt; <span class="hljs-number">0x12</span> | <span class="hljs-number">0xF0</span>,
        codePoint &gt;&gt; <span class="hljs-number">0xC</span> &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>,
        codePoint &gt;&gt; <span class="hljs-number">0x6</span> &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>,
        codePoint &amp; <span class="hljs-number">0x3F</span> | <span class="hljs-number">0x80</span>
      )
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Invalid code point'</span>)
    }
  }

  <span class="hljs-keyword">return</span> bytes
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asciiToBytes</span> (<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">var</span> byteArray = []
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; str.length; ++i) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67"></a>
</div>
<p>Node's code seems to be doing this and not &amp; 0x7F..</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    byteArray.push(str.charCodeAt(i) &amp; <span class="hljs-number">0xFF</span>)
  }
  <span class="hljs-keyword">return</span> byteArray
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">utf16leToBytes</span> (<span class="hljs-params">str, units</span>) </span>{
  <span class="hljs-keyword">var</span> c, hi, lo
  <span class="hljs-keyword">var</span> byteArray = []
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; str.length; ++i) {
    <span class="hljs-keyword">if</span> ((units -= <span class="hljs-number">2</span>) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>

    c = str.charCodeAt(i)
    hi = c &gt;&gt; <span class="hljs-number">8</span>
    lo = c % <span class="hljs-number">256</span>
    byteArray.push(lo)
    byteArray.push(hi)
  }

  <span class="hljs-keyword">return</span> byteArray
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">base64ToBytes</span> (<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">return</span> base64.toByteArray(base64clean(str))
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blitBuffer</span> (<span class="hljs-params">src, dst, offset, length</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; length; ++i) {
    <span class="hljs-keyword">if</span> ((i + offset &gt;= dst.length) || (i &gt;= src.length)) <span class="hljs-keyword">break</span>
    dst[i + offset] = src[i]
  }
  <span class="hljs-keyword">return</span> i
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isnan</span> (<span class="hljs-params">val</span>) </span>{
  <span class="hljs-keyword">return</span> val !== val <span class="hljs-comment">// eslint-disable-line no-self-compare</span>
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
