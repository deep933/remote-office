<!DOCTYPE html>
<html>
<head>
  <title>dependencies.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/babel-preset-react-app/dependencies.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>dependencies.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>Copyright (c) 2015-present, Facebook, Inc.</p>
</div>
<div class="body">
<p>This source code is licensed under the MIT license found in the
LICENSE file in the root directory of this source tree.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-keyword">const</span> validateBoolOption = <span class="hljs-function">(<span class="hljs-params">name, value, defaultValue</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'undefined'</span>) {
    value = defaultValue;
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'boolean'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Preset react-app: '<span class="hljs-subst">${name}</span>' option must be a boolean.`</span>);
  }

  <span class="hljs-keyword">return</span> value;
};

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">api, opts</span>) </span>{
  <span class="hljs-keyword">if</span> (!opts) {
    opts = {};
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>This is similar to how <code>env</code> works in Babel:
https://babeljs.io/docs/usage/babelrc/#env-option
We are not using <code>env</code> because it’s ignored in versions &gt; babel-core@6.10.4:
https://github.com/babel/babel/issues/4539
https://github.com/facebook/create-react-app/issues/720
It’s also nice that we can enforce <code>NODE_ENV</code> being specified.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> env = process.env.BABEL_ENV || process.env.NODE_ENV;
  <span class="hljs-keyword">var</span> isEnvDevelopment = env === <span class="hljs-string">'development'</span>;
  <span class="hljs-keyword">var</span> isEnvProduction = env === <span class="hljs-string">'production'</span>;
  <span class="hljs-keyword">var</span> isEnvTest = env === <span class="hljs-string">'test'</span>;

  <span class="hljs-keyword">var</span> areHelpersEnabled = validateBoolOption(<span class="hljs-string">'helpers'</span>, opts.helpers, <span class="hljs-literal">false</span>);
  <span class="hljs-keyword">var</span> useAbsoluteRuntime = validateBoolOption(
    <span class="hljs-string">'absoluteRuntime'</span>,
    opts.absoluteRuntime,
    <span class="hljs-literal">true</span>
  );

  <span class="hljs-keyword">var</span> absoluteRuntimePath = <span class="hljs-literal">undefined</span>;
  <span class="hljs-keyword">if</span> (useAbsoluteRuntime) {
    absoluteRuntimePath = path.dirname(
      <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">'@babel/runtime/package.json'</span>)
    );
  }

  <span class="hljs-keyword">if</span> (!isEnvDevelopment &amp;&amp; !isEnvProduction &amp;&amp; !isEnvTest) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">'Using `babel-preset-react-app` requires that you specify `NODE_ENV` or '</span> +
        <span class="hljs-string">'`BABEL_ENV` environment variables. Valid values are "development", '</span> +
        <span class="hljs-string">'"test", and "production". Instead, received: '</span> +
        <span class="hljs-built_in">JSON</span>.stringify(env) +
        <span class="hljs-string">'.'</span>
    );
  }

  <span class="hljs-keyword">return</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Babel assumes ES Modules, which isn't safe until CommonJS
dies. This changes the behavior to assume CommonJS unless
an <code>import</code> or <code>export</code> is present in the file.
https://github.com/webpack/webpack/issues/4039#issuecomment-419284940</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    sourceType: <span class="hljs-string">'unambiguous'</span>,
    <span class="hljs-attr">presets</span>: [
      isEnvTest &amp;&amp; [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>ES features necessary for user's Node version</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/preset-env'</span>).default,
        {
          <span class="hljs-attr">targets</span>: {
            <span class="hljs-attr">node</span>: <span class="hljs-string">'current'</span>,
          },
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Do not transform modules to CJS</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          modules: <span class="hljs-literal">false</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Exclude transforms that make all code slower</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          exclude: [<span class="hljs-string">'transform-typeof-symbol'</span>],
        },
      ],
      (isEnvProduction || isEnvDevelopment) &amp;&amp; [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Latest stable ECMAScript features</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/preset-env'</span>).default,
        {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Allow importing core-js in entrypoint and use browserlist to select polyfills</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          useBuiltIns: <span class="hljs-string">'entry'</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Set the corejs version we are using to avoid warnings in console
This will need to change once we upgrade to corejs@3</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          corejs: <span class="hljs-number">3</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Do not transform modules to CJS</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          modules: <span class="hljs-literal">false</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Exclude transforms that make all code slower</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          exclude: [<span class="hljs-string">'transform-typeof-symbol'</span>],
        },
      ],
    ].filter(<span class="hljs-built_in">Boolean</span>),
    <span class="hljs-attr">plugins</span>: [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>Disabled as it's handled automatically by preset-env, and <code>selectiveLoose</code> isn't
yet merged into babel: https://github.com/babel/babel/pull/9486
Related: https://github.com/facebook/create-react-app/pull/8215
[
require('@babel/plugin-transform-destructuring').default,
{
// Use loose mode for performance:
// https://github.com/facebook/create-react-app/issues/5602
loose: false,
selectiveLoose: [
'useState',
'useEffect',
'useContext',
'useReducer',
'useCallback',
'useMemo',
'useRef',
'useImperativeHandle',
'useLayoutEffect',
'useDebugValue',
],
},
],
Polyfills the runtime needed for async/await, generators, and friends
https://babeljs.io/docs/en/babel-plugin-transform-runtime</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      [
        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-transform-runtime'</span>).default,
        {
          <span class="hljs-attr">corejs</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">helpers</span>: areHelpersEnabled,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>By default, babel assumes babel/runtime version 7.0.0-beta.0,
explicitly resolving to match the provided helper functions.
https://github.com/babel/babel/issues/10261</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          version: <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/runtime/package.json'</span>).version,
          <span class="hljs-attr">regenerator</span>: <span class="hljs-literal">true</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>https://babeljs.io/docs/en/babel-plugin-transform-runtime#useesmodules
We should turn this on once the lowest version of Node LTS
supports ES Modules.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          useESModules: isEnvDevelopment || isEnvProduction,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Undocumented option that lets us encapsulate our runtime, ensuring
the correct version is used
https://github.com/babel/babel/blob/090c364a90fe73d36a30707fc612ce037bdbbb24/packages/babel-plugin-transform-runtime/src/index.js#L35-L42</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          absoluteRuntime: absoluteRuntimePath,
        },
      ],
    ].filter(<span class="hljs-built_in">Boolean</span>),
  };
};

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
