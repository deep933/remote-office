<!DOCTYPE html>
<html>
<head>
  <title>create.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/babel-preset-react-app/create.js";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>create.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>Copyright (c) 2015-present, Facebook, Inc.</p>
</div>
<div class="body">
<p>This source code is licensed under the MIT license found in the
LICENSE file in the root directory of this source tree.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-keyword">const</span> validateBoolOption = <span class="hljs-function">(<span class="hljs-params">name, value, defaultValue</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'undefined'</span>) {
    value = defaultValue;
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'boolean'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Preset react-app: '<span class="hljs-subst">${name}</span>' option must be a boolean.`</span>);
  }

  <span class="hljs-keyword">return</span> value;
};

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">api, opts, env</span>) </span>{
  <span class="hljs-keyword">if</span> (!opts) {
    opts = {};
  }

  <span class="hljs-keyword">var</span> isEnvDevelopment = env === <span class="hljs-string">'development'</span>;
  <span class="hljs-keyword">var</span> isEnvProduction = env === <span class="hljs-string">'production'</span>;
  <span class="hljs-keyword">var</span> isEnvTest = env === <span class="hljs-string">'test'</span>;

  <span class="hljs-keyword">var</span> useESModules = validateBoolOption(
    <span class="hljs-string">'useESModules'</span>,
    opts.useESModules,
    isEnvDevelopment || isEnvProduction
  );
  <span class="hljs-keyword">var</span> isFlowEnabled = validateBoolOption(<span class="hljs-string">'flow'</span>, opts.flow, <span class="hljs-literal">true</span>);
  <span class="hljs-keyword">var</span> isTypeScriptEnabled = validateBoolOption(
    <span class="hljs-string">'typescript'</span>,
    opts.typescript,
    <span class="hljs-literal">true</span>
  );
  <span class="hljs-keyword">var</span> areHelpersEnabled = validateBoolOption(<span class="hljs-string">'helpers'</span>, opts.helpers, <span class="hljs-literal">true</span>);
  <span class="hljs-keyword">var</span> useAbsoluteRuntime = validateBoolOption(
    <span class="hljs-string">'absoluteRuntime'</span>,
    opts.absoluteRuntime,
    <span class="hljs-literal">true</span>
  );

  <span class="hljs-keyword">var</span> absoluteRuntimePath = <span class="hljs-literal">undefined</span>;
  <span class="hljs-keyword">if</span> (useAbsoluteRuntime) {
    absoluteRuntimePath = path.dirname(
      <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">'@babel/runtime/package.json'</span>)
    );
  }

  <span class="hljs-keyword">if</span> (!isEnvDevelopment &amp;&amp; !isEnvProduction &amp;&amp; !isEnvTest) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">'Using `babel-preset-react-app` requires that you specify `NODE_ENV` or '</span> +
        <span class="hljs-string">'`BABEL_ENV` environment variables. Valid values are "development", '</span> +
        <span class="hljs-string">'"test", and "production". Instead, received: '</span> +
        <span class="hljs-built_in">JSON</span>.stringify(env) +
        <span class="hljs-string">'.'</span>
    );
  }

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">presets</span>: [
      isEnvTest &amp;&amp; [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>ES features necessary for user's Node version</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/preset-env'</span>).default,
        {
          <span class="hljs-attr">targets</span>: {
            <span class="hljs-attr">node</span>: <span class="hljs-string">'current'</span>,
          },
        },
      ],
      (isEnvProduction || isEnvDevelopment) &amp;&amp; [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Latest stable ECMAScript features</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/preset-env'</span>).default,
        {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Allow importing core-js in entrypoint and use browserlist to select polyfills</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          useBuiltIns: <span class="hljs-string">'entry'</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Set the corejs version we are using to avoid warnings in console
This will need to change once we upgrade to corejs@3</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          corejs: <span class="hljs-number">3</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Do not transform modules to CJS</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          modules: <span class="hljs-literal">false</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Exclude transforms that make all code slower</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          exclude: [<span class="hljs-string">'transform-typeof-symbol'</span>],
        },
      ],
      [
        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/preset-react'</span>).default,
        {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Adds component stack to warning messages
Adds __self attribute to JSX which React will use for some warnings</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          development: isEnvDevelopment || isEnvTest,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Will use the native built-in instead of trying to polyfill
behavior for any plugins that require one.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          useBuiltIns: <span class="hljs-literal">true</span>,
        },
      ],
      isTypeScriptEnabled &amp;&amp; [<span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/preset-typescript'</span>).default],
    ].filter(<span class="hljs-built_in">Boolean</span>),
    <span class="hljs-attr">plugins</span>: [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Strip flow types before any other transform, emulating the behavior
order as-if the browser supported all of the succeeding features
https://github.com/facebook/create-react-app/pull/5182
We will conditionally enable this plugin below in overrides as it clashes with
@babel/plugin-proposal-decorators when using TypeScript.
https://github.com/facebook/create-react-app/issues/5741</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      isFlowEnabled &amp;&amp; [
        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-transform-flow-strip-types'</span>).default,
        <span class="hljs-literal">false</span>,
      ],
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Experimental macros support. Will be documented after it's had some time
in the wild.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-built_in">require</span>(<span class="hljs-string">'babel-plugin-macros'</span>),
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>Disabled as it's handled automatically by preset-env, and <code>selectiveLoose</code> isn't
yet merged into babel: https://github.com/babel/babel/pull/9486
Related: https://github.com/facebook/create-react-app/pull/8215
[
require('@babel/plugin-transform-destructuring').default,
{
// Use loose mode for performance:
// https://github.com/facebook/create-react-app/issues/5602
loose: false,
selectiveLoose: [
'useState',
'useEffect',
'useContext',
'useReducer',
'useCallback',
'useMemo',
'useRef',
'useImperativeHandle',
'useLayoutEffect',
'useDebugValue',
],
},
],
Turn on legacy decorators for TypeScript files</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      isTypeScriptEnabled &amp;&amp; [
        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-proposal-decorators'</span>).default,
        <span class="hljs-literal">false</span>,
      ],
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>class { handleClick = () =&gt; { } }
Enable loose mode to use assignment instead of defineProperty
See discussion in https://github.com/facebook/create-react-app/issues/4263</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      [
        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-proposal-class-properties'</span>).default,
        {
          <span class="hljs-attr">loose</span>: <span class="hljs-literal">true</span>,
        },
      ],
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>Adds Numeric Separators</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-proposal-numeric-separator'</span>).default,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Polyfills the runtime needed for async/await, generators, and friends
https://babeljs.io/docs/en/babel-plugin-transform-runtime</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      [
        <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-transform-runtime'</span>).default,
        {
          <span class="hljs-attr">corejs</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">helpers</span>: areHelpersEnabled,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>By default, babel assumes babel/runtime version 7.0.0-beta.0,
explicitly resolving to match the provided helper functions.
https://github.com/babel/babel/issues/10261</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          version: <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/runtime/package.json'</span>).version,
          <span class="hljs-attr">regenerator</span>: <span class="hljs-literal">true</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>https://babeljs.io/docs/en/babel-plugin-transform-runtime#useesmodules
We should turn this on once the lowest version of Node LTS
supports ES Modules.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          useESModules,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>Undocumented option that lets us encapsulate our runtime, ensuring
the correct version is used
https://github.com/babel/babel/blob/090c364a90fe73d36a30707fc612ce037bdbbb24/packages/babel-plugin-transform-runtime/src/index.js#L35-L42</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          absoluteRuntime: absoluteRuntimePath,
        },
      ],
      isEnvProduction &amp;&amp; [
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>Remove PropTypes from production build</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-built_in">require</span>(<span class="hljs-string">'babel-plugin-transform-react-remove-prop-types'</span>).default,
        {
          <span class="hljs-attr">removeImport</span>: <span class="hljs-literal">true</span>,
        },
      ],
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>Optional chaining and nullish coalescing are supported in @babel/preset-env,
but not yet supported in webpack due to support missing from acorn.
These can be removed once webpack has support.
See https://github.com/facebook/create-react-app/issues/8445#issuecomment-588512250</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-proposal-optional-chaining'</span>).default,
      <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-proposal-nullish-coalescing-operator'</span>).default,
    ].filter(<span class="hljs-built_in">Boolean</span>),
    <span class="hljs-attr">overrides</span>: [
      isFlowEnabled &amp;&amp; {
        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/\.tsx?$/</span>,
        <span class="hljs-attr">plugins</span>: [<span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-transform-flow-strip-types'</span>).default],
      },
      isTypeScriptEnabled &amp;&amp; {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.tsx?$/</span>,
        <span class="hljs-attr">plugins</span>: [
          [
            <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/plugin-proposal-decorators'</span>).default,
            { <span class="hljs-attr">legacy</span>: <span class="hljs-literal">true</span> },
          ],
        ],
      },
    ].filter(<span class="hljs-built_in">Boolean</span>),
  };
};

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
